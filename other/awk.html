<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Awk Cheat Sheet | 油腻中年大叔</title>
    <meta name="description" content="你想要的这里都没有，你不想要的这里都有">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    
    <link rel="preload" href="/assets/css/styles.7863e8ac.css" as="style"><link rel="preload" href="/assets/js/app.7863e8ac.js" as="script"><link rel="preload" href="/assets/js/41.1921a30c.js" as="script"><link rel="prefetch" href="/assets/js/0.eb7108e7.js"><link rel="prefetch" href="/assets/js/1.d8ec4d72.js"><link rel="prefetch" href="/assets/js/2.28f90b8d.js"><link rel="prefetch" href="/assets/js/3.6001361f.js"><link rel="prefetch" href="/assets/js/4.80c27a58.js"><link rel="prefetch" href="/assets/js/5.2e2f809b.js"><link rel="prefetch" href="/assets/js/6.0d0d8441.js"><link rel="prefetch" href="/assets/js/7.8e4037c3.js"><link rel="prefetch" href="/assets/js/8.5752a787.js"><link rel="prefetch" href="/assets/js/9.8329deb8.js"><link rel="prefetch" href="/assets/js/10.4843c5ba.js"><link rel="prefetch" href="/assets/js/11.9e8b7549.js"><link rel="prefetch" href="/assets/js/12.02c0fa30.js"><link rel="prefetch" href="/assets/js/13.f5d738e8.js"><link rel="prefetch" href="/assets/js/14.ca4b3249.js"><link rel="prefetch" href="/assets/js/15.cf61b2ec.js"><link rel="prefetch" href="/assets/js/16.2b67aa0e.js"><link rel="prefetch" href="/assets/js/17.b99a459f.js"><link rel="prefetch" href="/assets/js/18.2d5afa9a.js"><link rel="prefetch" href="/assets/js/19.6c36dff4.js"><link rel="prefetch" href="/assets/js/20.3e0dc870.js"><link rel="prefetch" href="/assets/js/21.227ee5ec.js"><link rel="prefetch" href="/assets/js/22.05c1f0f0.js"><link rel="prefetch" href="/assets/js/23.c6dbeed0.js"><link rel="prefetch" href="/assets/js/24.957b4252.js"><link rel="prefetch" href="/assets/js/25.b50e4879.js"><link rel="prefetch" href="/assets/js/26.1b2b16cf.js"><link rel="prefetch" href="/assets/js/27.2f0f5e4c.js"><link rel="prefetch" href="/assets/js/28.ffafaa79.js"><link rel="prefetch" href="/assets/js/29.38ab4732.js"><link rel="prefetch" href="/assets/js/30.7258c2eb.js"><link rel="prefetch" href="/assets/js/31.6cc6f25e.js"><link rel="prefetch" href="/assets/js/32.cae8f5c2.js"><link rel="prefetch" href="/assets/js/33.7bac5900.js"><link rel="prefetch" href="/assets/js/34.e457a7ab.js"><link rel="prefetch" href="/assets/js/35.6a4f99be.js"><link rel="prefetch" href="/assets/js/36.3fa7b425.js"><link rel="prefetch" href="/assets/js/37.9627a576.js"><link rel="prefetch" href="/assets/js/38.8f902270.js"><link rel="prefetch" href="/assets/js/39.2fb6b1fd.js"><link rel="prefetch" href="/assets/js/40.0f992849.js"><link rel="prefetch" href="/assets/js/42.196053b0.js"><link rel="prefetch" href="/assets/js/43.6a2cc6b2.js"><link rel="prefetch" href="/assets/js/44.c3b31b69.js"><link rel="prefetch" href="/assets/js/45.dd90e897.js"><link rel="prefetch" href="/assets/js/46.547a7ce9.js"><link rel="prefetch" href="/assets/js/47.a62be284.js"><link rel="prefetch" href="/assets/js/48.edc6618c.js"><link rel="prefetch" href="/assets/js/49.b3d5118e.js"><link rel="prefetch" href="/assets/js/50.81540475.js"><link rel="prefetch" href="/assets/js/51.c2c1171b.js"><link rel="prefetch" href="/assets/js/52.ba318094.js"><link rel="prefetch" href="/assets/js/53.a2d5d15e.js"><link rel="prefetch" href="/assets/js/54.3608cfdf.js"><link rel="prefetch" href="/assets/js/55.73c0d459.js"><link rel="prefetch" href="/assets/js/56.9706fe8c.js"><link rel="prefetch" href="/assets/js/57.f5a08e9a.js"><link rel="prefetch" href="/assets/js/58.ea9c9ad0.js"><link rel="prefetch" href="/assets/js/59.9d363669.js"><link rel="prefetch" href="/assets/js/60.8a80b28f.js"><link rel="prefetch" href="/assets/js/61.73e5c6a8.js"><link rel="prefetch" href="/assets/js/62.30aab875.js"><link rel="prefetch" href="/assets/js/63.1e86c5c0.js"><link rel="prefetch" href="/assets/js/64.9c071a1e.js"><link rel="prefetch" href="/assets/js/65.61d8d11c.js"><link rel="prefetch" href="/assets/js/66.dd39544e.js"><link rel="prefetch" href="/assets/js/67.6dd79cd2.js"><link rel="prefetch" href="/assets/js/68.dd07b2a3.js"><link rel="prefetch" href="/assets/js/69.a5a81dbc.js"><link rel="prefetch" href="/assets/js/70.3f26faed.js"><link rel="prefetch" href="/assets/js/71.1234830b.js"><link rel="prefetch" href="/assets/js/72.d4db7f16.js"><link rel="prefetch" href="/assets/js/73.e2b0a283.js"><link rel="prefetch" href="/assets/js/74.db6d3ebc.js"><link rel="prefetch" href="/assets/js/75.4516323c.js"><link rel="prefetch" href="/assets/js/76.a086fd94.js"><link rel="prefetch" href="/assets/js/77.165f6d28.js"><link rel="prefetch" href="/assets/js/78.81cd058e.js"><link rel="prefetch" href="/assets/js/79.fde8c00b.js"><link rel="prefetch" href="/assets/js/80.142b728c.js"><link rel="prefetch" href="/assets/js/81.367c9c5e.js"><link rel="prefetch" href="/assets/js/82.d23176e0.js"><link rel="prefetch" href="/assets/js/83.d9571f6f.js"><link rel="prefetch" href="/assets/js/84.6214056c.js"><link rel="prefetch" href="/assets/js/85.66cc6092.js"><link rel="prefetch" href="/assets/js/86.18dba812.js"><link rel="prefetch" href="/assets/js/87.9506d9f8.js"><link rel="prefetch" href="/assets/js/88.b42d6720.js"><link rel="prefetch" href="/assets/js/89.5c0033c4.js"><link rel="prefetch" href="/assets/js/90.069a50d4.js"><link rel="prefetch" href="/assets/js/91.61fe3c31.js"><link rel="prefetch" href="/assets/js/92.e4211585.js"><link rel="prefetch" href="/assets/js/93.6df74471.js"><link rel="prefetch" href="/assets/js/94.d61ebe6e.js"><link rel="prefetch" href="/assets/js/95.c60c8a69.js"><link rel="prefetch" href="/assets/js/96.e3124488.js"><link rel="prefetch" href="/assets/js/97.bce37e32.js"><link rel="prefetch" href="/assets/js/98.a1fb95ac.js"><link rel="prefetch" href="/assets/js/99.f9c12b84.js"><link rel="prefetch" href="/assets/js/100.0b3aaca9.js"><link rel="prefetch" href="/assets/js/101.03f32ae7.js"><link rel="prefetch" href="/assets/js/102.69cca032.js"><link rel="prefetch" href="/assets/js/103.190dc3ef.js"><link rel="prefetch" href="/assets/js/104.6e7ceda7.js"><link rel="prefetch" href="/assets/js/105.f852f5a7.js"><link rel="prefetch" href="/assets/js/106.9335f238.js"><link rel="prefetch" href="/assets/js/107.1404f516.js"><link rel="prefetch" href="/assets/js/108.dd6bb5e3.js"><link rel="prefetch" href="/assets/js/109.a87f5640.js"><link rel="prefetch" href="/assets/js/110.fb0da049.js"><link rel="prefetch" href="/assets/js/111.cc64ddd7.js"><link rel="prefetch" href="/assets/css/112.styles.75c39ee5.css"><link rel="prefetch" href="/assets/js/112.75c39ee5.js"><link rel="prefetch" href="/assets/css/113.styles.407e8d7f.css"><link rel="prefetch" href="/assets/js/113.407e8d7f.js">
    <link rel="stylesheet" href="/assets/css/112.styles.75c39ee5.css"><link rel="stylesheet" href="/assets/css/113.styles.407e8d7f.css"><link rel="stylesheet" href="/assets/css/styles.7863e8ac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">油腻中年大叔</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dart/" class="nav-link">Dart</a></div><div class="nav-item"><a href="/spring/" class="nav-link">spring</a></div><div class="nav-item"><a href="/drools/" class="nav-link">规则和业务流程</a></div><div class="nav-item"><a href="/eip/" class="nav-link">EIP集成工具</a></div><div class="nav-item"><a href="/other/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/algorithms/" class="nav-link">算法</a></div><div class="nav-item"><a href="/riding/" class="nav-link">骑行</a></div><div class="nav-item"><a href="/ev3/" class="nav-link">LEGO EV3 </a></div><div class="nav-item"><a href="/rubik/" class="nav-link">魔方</a></div><div class="nav-item"><a href="/mb/" class="nav-link">Micro:bit </a></div><div class="nav-item"><a href="/math/" class="nav-link">小学数学 </a></div><div class="nav-item"><a href="/eng/" class="nav-link">小学英语 </a></div><div class="nav-item"><a href="/jp/" class="nav-link">日语 </a></div><div class="nav-item"><a href="/gs1/" class="nav-link">GS-1</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dart/" class="nav-link">Dart</a></div><div class="nav-item"><a href="/spring/" class="nav-link">spring</a></div><div class="nav-item"><a href="/drools/" class="nav-link">规则和业务流程</a></div><div class="nav-item"><a href="/eip/" class="nav-link">EIP集成工具</a></div><div class="nav-item"><a href="/other/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/algorithms/" class="nav-link">算法</a></div><div class="nav-item"><a href="/riding/" class="nav-link">骑行</a></div><div class="nav-item"><a href="/ev3/" class="nav-link">LEGO EV3 </a></div><div class="nav-item"><a href="/rubik/" class="nav-link">魔方</a></div><div class="nav-item"><a href="/mb/" class="nav-link">Micro:bit </a></div><div class="nav-item"><a href="/math/" class="nav-link">小学数学 </a></div><div class="nav-item"><a href="/eng/" class="nav-link">小学英语 </a></div><div class="nav-item"><a href="/jp/" class="nav-link">日语 </a></div><div class="nav-item"><a href="/gs1/" class="nav-link">GS-1</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/other/aws-deploy.html" class="sidebar-link">AWS VPC网络部署参考</a></li><li><a href="/other/iot.html" class="sidebar-link">aws IoT</a></li><li><a href="/other/aws.html" class="sidebar-link">aws 常用操作</a></li><li><a href="/other/singletonAndMultiton.html" class="sidebar-link">Design Pattern Series: Singleton and Multiton Pattern</a></li><li><a href="/other/magick.html" class="sidebar-link">Image Magick参考</a></li><li><a href="/other/oss.html" class="sidebar-link">阿里OSS使用技巧</a></li><li><a href="/other/awk.html" class="active sidebar-link">awk cheat sheet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/awk.html#每行后面增加一行空行" class="sidebar-link">每行后面增加一行空行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#每行后面增加两行空行" class="sidebar-link">每行后面增加两行空行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#编号和计算：" class="sidebar-link">编号和计算：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/awk.html#以文件为单位，在每句行前加上编号-（左对齐）" class="sidebar-link">以文件为单位，在每句行前加上编号 （左对齐）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#用制表符-（-t）-给所有文件加上连贯的编号。" class="sidebar-link">用制表符 （\t） 给所有文件加上连贯的编号。</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#给非空白行的行加上编号" class="sidebar-link">给非空白行的行加上编号</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#计算行数-（模拟-wc-l-）" class="sidebar-link">计算行数 （模拟 &quot;wc -l&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#计算每行每个区域之和" class="sidebar-link">计算每行每个区域之和</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#计算所有行所有区域的总和" class="sidebar-link">计算所有行所有区域的总和</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印每行每区域的绝对值" class="sidebar-link">打印每行每区域的绝对值</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#计算所有行所有区域（词）的个数" class="sidebar-link">计算所有行所有区域（词）的个数</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印包含-beth-的行数" class="sidebar-link">打印包含 &quot;Beth&quot; 的行数</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印第一列最大的行-并且在行前打印出这个最大的数" class="sidebar-link">打印第一列最大的行   并且在行前打印出这个最大的数</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印每行的列数，并在后面跟上此行内容" class="sidebar-link">打印每行的列数，并在后面跟上此行内容</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印每行的最后一列" class="sidebar-link">打印每行的最后一列</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印最后一行的最后一列" class="sidebar-link">打印最后一行的最后一列</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印列数超过4的行" class="sidebar-link">打印列数超过4的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印最后一列大于4的行" class="sidebar-link">打印最后一列大于4的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#构建一指定长度的字符串（比如，513个空格）" class="sidebar-link">构建一指定长度的字符串（比如，513个空格）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#在某一位置中插入以特定长度的字符串" class="sidebar-link">在某一位置中插入以特定长度的字符串</a></li></ul></li><li class="sidebar-sub-header"><a href="/other/awk.html#构建数组：" class="sidebar-link">构建数组：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/awk.html#构建一个叫-month-的数组，以数字为索引，month-1-就是-jan-，month-2-就是-feb-，month-3-就是-mar-，以此类推。" class="sidebar-link">构建一个叫&quot;month&quot;的数组，以数字为索引，month[1]就是'Jan'，month[2]就是   'Feb'，month[3]就是'Mar'，以此类推。</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#构建一个叫-mdigit-的数组，以字符串为索引，mdigit-jan-等于-1，" class="sidebar-link">构建一个叫&quot;mdigit&quot;的数组，以字符串为索引，mdigit[&quot;Jan&quot;] 等于 1，</a></li></ul></li><li class="sidebar-sub-header"><a href="/other/awk.html#文本转换和替代：" class="sidebar-link">文本转换和替代：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/awk.html#在unix环境：转换dos新行-（cr-lf）-为unix格式" class="sidebar-link">在Unix环境：转换DOS新行 （CR/LF） 为Unix格式</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#在unix环境：转换unix新行-（lf）-为dos格式" class="sidebar-link">在Unix环境：转换Unix新行 （LF） 为DOS格式</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#在dos环境：转换dos新行-（cr-lf）-为unix格式-dos版本的awk不能运行-只能用gawk" class="sidebar-link">在DOS环境：转换DOS新行 （CR/LF） 为Unix格式    DOS版本的awk不能运行, 只能用gawk:</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#删除每行前的空白（包括空格符和制表符）" class="sidebar-link">删除每行前的空白（包括空格符和制表符）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#删除每行结尾的空白（包括空格符和制表符）" class="sidebar-link">删除每行结尾的空白（包括空格符和制表符）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#删除每行开头和结尾的所有空白（包括空格符和制表符）" class="sidebar-link">删除每行开头和结尾的所有空白（包括空格符和制表符）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#在每一行开头处插入5个空格-（做整页的左位移）" class="sidebar-link">在每一行开头处插入5个空格 （做整页的左位移）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#用79个字符为宽度，将全部文本右对齐" class="sidebar-link">用79个字符为宽度，将全部文本右对齐</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#用79个字符为宽度，将全部文本居中对齐" class="sidebar-link">用79个字符为宽度，将全部文本居中对齐</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#每行用-bar-查找替换-foo" class="sidebar-link">每行用 &quot;bar&quot; 查找替换 &quot;foo&quot;</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#在包含-baz-的行里，将-foo-替换为-bar" class="sidebar-link">在包含 &quot;baz&quot; 的行里，将 &quot;foo&quot; 替换为 &quot;bar&quot;</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#在不包含-baz-的行里，将-foo-替换为-bar" class="sidebar-link">在不包含 &quot;baz&quot; 的行里，将 &quot;foo&quot; 替换为 &quot;bar&quot;</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#将-scarlet-或者-ruby-或者-puce-替换为-red" class="sidebar-link">将 &quot;scarlet&quot; 或者 &quot;ruby&quot; 或者 &quot;puce&quot; 替换为 &quot;red&quot;</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#倒排文本-（模拟-tac-）" class="sidebar-link">倒排文本 （模拟 &quot;tac&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#如果一行结尾为反斜线符，将下一行接到这行后面" class="sidebar-link">如果一行结尾为反斜线符，将下一行接到这行后面</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#排序并打印所有登录用户的姓名" class="sidebar-link">排序并打印所有登录用户的姓名</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#以相反的顺序打印出每行的前两列" class="sidebar-link">以相反的顺序打印出每行的前两列</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#调换前两列的位置" class="sidebar-link">调换前两列的位置</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印每行，并删除第二列" class="sidebar-link">打印每行，并删除第二列</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#倒置每行并打印" class="sidebar-link">倒置每行并打印</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#用逗号链接每5行" class="sidebar-link">用逗号链接每5行</a></li></ul></li><li class="sidebar-sub-header"><a href="/other/awk.html#择性的打印某些行：" class="sidebar-link">择性的打印某些行：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/awk.html#打印文件的前十行-（模拟-head-）" class="sidebar-link">打印文件的前十行 （模拟 &quot;head&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印文件的第一行-（模拟-head-1-）" class="sidebar-link">打印文件的第一行 （模拟 &quot;head -1&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印文件的最后两行-（模拟-tail-2-）" class="sidebar-link">打印文件的最后两行 （模拟 &quot;tail -2&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印文件的最后一行-（模拟-tail-1-）" class="sidebar-link">打印文件的最后一行 （模拟 &quot;tail -1&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印不匹配正则表达式的行-（模拟-grep-v-）" class="sidebar-link">打印不匹配正则表达式的行 （模拟 &quot;grep -v&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印第5列等于-abc123-的行" class="sidebar-link">打印第5列等于&quot;abc123&quot;的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印第5列不等于-abc123-的行" class="sidebar-link">打印第5列不等于&quot;abc123&quot;的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#用正则匹配某一列" class="sidebar-link">用正则匹配某一列</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印匹配正则表达式的前一行，但是不打印当前行" class="sidebar-link">打印匹配正则表达式的前一行，但是不打印当前行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印匹配正则表达式的后一行，但是不打印当前行" class="sidebar-link">打印匹配正则表达式的后一行，但是不打印当前行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#以任何顺序查找包含-aaa、bbb-和-ccc-的行" class="sidebar-link">以任何顺序查找包含 AAA、BBB 和 CCC 的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#以指定顺序查找包含-aaa、bbb-和-ccc-的行" class="sidebar-link">以指定顺序查找包含 AAA、BBB 和 CCC 的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印长度大于64个字节的行" class="sidebar-link">打印长度大于64个字节的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印长度小于64个字节的行" class="sidebar-link">打印长度小于64个字节的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印从匹配正则起到文件末尾的内容" class="sidebar-link">打印从匹配正则起到文件末尾的内容</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印指定行之间的内容-（8-12行-包括第8和第12行）" class="sidebar-link">打印指定行之间的内容 （8-12行, 包括第8和第12行）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印第52行" class="sidebar-link">打印第52行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#打印两个正则匹配间的内容-（包括正则的内容）" class="sidebar-link">打印两个正则匹配间的内容 （包括正则的内容）</a></li></ul></li><li class="sidebar-sub-header"><a href="/other/awk.html#选择性的删除某些行：" class="sidebar-link">选择性的删除某些行：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/awk.html#删除所有空白行-（类似于-grep-）" class="sidebar-link">删除所有空白行 （类似于 &quot;grep '.' &quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#删除重复连续的行-（模拟-uniq-）" class="sidebar-link">删除重复连续的行 （模拟 &quot;uniq&quot;）</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#删除重复的、非连续的行" class="sidebar-link">删除重复的、非连续的行</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#提取日志中的手机号并且统计" class="sidebar-link">提取日志中的手机号并且统计</a></li></ul></li><li class="sidebar-sub-header"><a href="/other/awk.html#command-reference" class="sidebar-link">Command Reference</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/awk.html#basics-i" class="sidebar-link">Basics I</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#variables-i" class="sidebar-link">Variables I</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#basics-ii" class="sidebar-link">Basics II</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#one-line-exercises-i" class="sidebar-link">One-Line Exercises I</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#variables-ii" class="sidebar-link">Variables II</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#variables-iii" class="sidebar-link">Variables III</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#functions-i" class="sidebar-link">Functions I</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#functions-ii" class="sidebar-link">Functions II</a></li><li class="sidebar-sub-header"><a href="/other/awk.html#functions-iii" class="sidebar-link">Functions III</a></li></ul></li></ul></li><li><a href="/other/redissearch.html" class="sidebar-link">Redis search with Lua</a></li><li><a href="/other/shell.html" class="sidebar-link">我的shell环境</a></li><li><a href="/other/mongo.html" class="sidebar-link">Mongo 常用操作</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="awk-cheat-sheet"><a href="#awk-cheat-sheet" aria-hidden="true" class="header-anchor">#</a> Awk Cheat Sheet</h1> <h2 id="每行后面增加一行空行"><a href="#每行后面增加一行空行" aria-hidden="true" class="header-anchor">#</a> 每行后面增加一行空行</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">awk</span> <span class="token string">'1;{print &quot;&quot;}'</span>   
<span class="token function">awk</span> <span class="token string">'BEGIN{ORS=&quot;\n\n&quot;};1'</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><blockquote><p>每行后面增加一行空行。输出文件不会包含连续的两个或两个以上的空行<br>
注意：在Unix系统， DOS行包括的 CRLF （\r\n） 通常会被作为非空行对待<br>
因此 'NF' 将会返回TRUE。</p></blockquote></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">awk</span> <span class="token string">'NF{print <span class="token variable">$0</span> &quot;\n&quot;}'</span>   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="每行后面增加两行空行"><a href="#每行后面增加两行空行" aria-hidden="true" class="header-anchor">#</a> 每行后面增加两行空行</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">awk</span> '1<span class="token punctuation">;</span><span class="token punctuation">{</span>print <span class="token string">&quot;\n&quot;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="编号和计算："><a href="#编号和计算：" aria-hidden="true" class="header-anchor">#</a> 编号和计算：</h2> <h3 id="以文件为单位，在每句行前加上编号-（左对齐）"><a href="#以文件为单位，在每句行前加上编号-（左对齐）" aria-hidden="true" class="header-anchor">#</a> 以文件为单位，在每句行前加上编号 （左对齐）</h3> <p>使用制表符 （\t） 来代替空格可以有效保护页变的空白。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{print FNR &quot;\t&quot; $0}' files*   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="用制表符-（-t）-给所有文件加上连贯的编号。"><a href="#用制表符-（-t）-给所有文件加上连贯的编号。" aria-hidden="true" class="header-anchor">#</a> 用制表符 （\t） 给所有文件加上连贯的编号。</h3> <p>awk '{print NR &quot;\t&quot; $0}' files*</p> <p>##3 以文件为单位，在每句行前加上编号 （编号在左，右对齐）<br>
如果在DOS环境下，需要写两个'%'</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{printf(&quot;%5d : %s\n&quot;, NR,$0)}'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="给非空白行的行加上编号"><a href="#给非空白行的行加上编号" aria-hidden="true" class="header-anchor">#</a> 给非空白行的行加上编号</h3> <p>记得Unix对于 \r 的处理的特殊之处。（上面已经提到）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk 'NF{$0=++a &quot; :&quot; $0};{print}'   
awk '{print (NF? ++a &quot; :&quot; :&quot;&quot;) $0}'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="计算行数-（模拟-wc-l-）"><a href="#计算行数-（模拟-wc-l-）" aria-hidden="true" class="header-anchor">#</a> 计算行数 （模拟 &quot;wc -l&quot;）</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk 'END{print NR}'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="计算每行每个区域之和"><a href="#计算每行每个区域之和" aria-hidden="true" class="header-anchor">#</a> 计算每行每个区域之和</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{s=0; for (i=1; i&lt;=NF; i++) s=s+$i; print s}'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="计算所有行所有区域的总和"><a href="#计算所有行所有区域的总和" aria-hidden="true" class="header-anchor">#</a> 计算所有行所有区域的总和</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{for (i=1; i&lt;=NF; i++) s=s+$i}; END{print s}'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印每行每区域的绝对值"><a href="#打印每行每区域的绝对值" aria-hidden="true" class="header-anchor">#</a> 打印每行每区域的绝对值</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{for (i=1; i&lt;=NF; i++) if ($i &lt; 0) $i = -$i; print }'   
awk '{for (i=1; i&lt;=NF; i++) $i = ($i &lt; 0) ? -$i : $i; print }'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="计算所有行所有区域（词）的个数"><a href="#计算所有行所有区域（词）的个数" aria-hidden="true" class="header-anchor">#</a> 计算所有行所有区域（词）的个数</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{ total = total + NF }; END {print total}' file  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印包含-beth-的行数"><a href="#打印包含-beth-的行数" aria-hidden="true" class="header-anchor">#</a> 打印包含 &quot;Beth&quot; 的行数</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '/Beth/{n++}; END {print n+0}' file  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印第一列最大的行-并且在行前打印出这个最大的数"><a href="#打印第一列最大的行-并且在行前打印出这个最大的数" aria-hidden="true" class="header-anchor">#</a> 打印第一列最大的行   并且在行前打印出这个最大的数</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '$1 &gt; max {max=$1; maxline=$0}; END{ print max, maxline}'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印每行的列数，并在后面跟上此行内容"><a href="#打印每行的列数，并在后面跟上此行内容" aria-hidden="true" class="header-anchor">#</a> 打印每行的列数，并在后面跟上此行内容</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{ print NF &quot;:&quot; $0 } '   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印每行的最后一列"><a href="#打印每行的最后一列" aria-hidden="true" class="header-anchor">#</a> 打印每行的最后一列</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{ print $NF }'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印最后一行的最后一列"><a href="#打印最后一行的最后一列" aria-hidden="true" class="header-anchor">#</a> 打印最后一行的最后一列</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '{ field = $NF }; END{ print field }'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印列数超过4的行"><a href="#打印列数超过4的行" aria-hidden="true" class="header-anchor">#</a> 打印列数超过4的行</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk 'NF &gt; 4'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="打印最后一列大于4的行"><a href="#打印最后一列大于4的行" aria-hidden="true" class="header-anchor">#</a> 打印最后一列大于4的行</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk '$NF &gt; 4'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>##构建字符串：</p> <h3 id="构建一指定长度的字符串（比如，513个空格）"><a href="#构建一指定长度的字符串（比如，513个空格）" aria-hidden="true" class="header-anchor">#</a> 构建一指定长度的字符串（比如，513个空格）</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>awk 'BEGIN{while (a++&lt;513) s=s &quot; &quot;; print s}'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="在某一位置中插入以特定长度的字符串"><a href="#在某一位置中插入以特定长度的字符串" aria-hidden="true" class="header-anchor">#</a> 在某一位置中插入以特定长度的字符串</h3> <p>例子：在每行第6列后插入49个空格</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>gawk --re-interval 'BEGIN{while(a++&lt;49)s=s &quot; &quot;};{sub(/^.{6}/,&quot;&amp;&quot; s)};1'   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="构建数组："><a href="#构建数组：" aria-hidden="true" class="header-anchor">#</a> 构建数组：</h2> <blockquote><blockquote><p>以下两个部分并不是一句话脚本，但是这些技巧相当便捷所以也包括进来</p></blockquote></blockquote> <h3 id="构建一个叫-month-的数组，以数字为索引，month-1-就是-jan-，month-2-就是-feb-，month-3-就是-mar-，以此类推。"><a href="#构建一个叫-month-的数组，以数字为索引，month-1-就是-jan-，month-2-就是-feb-，month-3-就是-mar-，以此类推。" aria-hidden="true" class="header-anchor">#</a> 构建一个叫&quot;month&quot;的数组，以数字为索引，month[1]就是'Jan'，month[2]就是   'Feb'，month[3]就是'Mar'，以此类推。</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>split(&quot;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec&quot;, month, &quot; &quot;)   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="构建一个叫-mdigit-的数组，以字符串为索引，mdigit-jan-等于-1，"><a href="#构建一个叫-mdigit-的数组，以字符串为索引，mdigit-jan-等于-1，" aria-hidden="true" class="header-anchor">#</a> 构建一个叫&quot;mdigit&quot;的数组，以字符串为索引，mdigit[&quot;Jan&quot;] 等于 1，</h3> <h1 id="mdigit-feb-等于-2，等等。需要有-month-数组。"><a href="#mdigit-feb-等于-2，等等。需要有-month-数组。" aria-hidden="true" class="header-anchor">#</a> mdigit[&quot;Feb&quot;] 等于 2，等等。需要有&quot;month&quot;数组。</h1> <p>for (i=1; i&lt;=12; i++) m_digit[month[i]] = i</p> <h2 id="文本转换和替代："><a href="#文本转换和替代：" aria-hidden="true" class="header-anchor">#</a> 文本转换和替代：</h2> <h3 id="在unix环境：转换dos新行-（cr-lf）-为unix格式"><a href="#在unix环境：转换dos新行-（cr-lf）-为unix格式" aria-hidden="true" class="header-anchor">#</a> 在Unix环境：转换DOS新行 （CR/LF） 为Unix格式</h3> <p>awk '{sub(/\r$/,&quot;&quot;)};1'   # 假设每行都以Ctrl-M结尾</p> <h3 id="在unix环境：转换unix新行-（lf）-为dos格式"><a href="#在unix环境：转换unix新行-（lf）-为dos格式" aria-hidden="true" class="header-anchor">#</a> 在Unix环境：转换Unix新行 （LF） 为DOS格式</h3> <p>awk '{sub(/$/,&quot;\r&quot;)};1'</p> <h1 id="在dos环境：转换unix新行-（lf）-为dos格式"><a href="#在dos环境：转换unix新行-（lf）-为dos格式" aria-hidden="true" class="header-anchor">#</a> 在DOS环境：转换Unix新行 （LF） 为DOS格式</h1> <p>awk 1</p> <h3 id="在dos环境：转换dos新行-（cr-lf）-为unix格式-dos版本的awk不能运行-只能用gawk"><a href="#在dos环境：转换dos新行-（cr-lf）-为unix格式-dos版本的awk不能运行-只能用gawk" aria-hidden="true" class="header-anchor">#</a> 在DOS环境：转换DOS新行 （CR/LF） 为Unix格式    DOS版本的awk不能运行, 只能用gawk:</h3> <p>gawk -v BINMODE=&quot;w&quot; '1' infile &gt;outfile</p> <p>###用 &quot;tr&quot; 替代的方法。<br>
tr -d \r &lt;infile &gt;outfile            # GNU tr 版本为 1.22 或者更高</p> <h3 id="删除每行前的空白（包括空格符和制表符）"><a href="#删除每行前的空白（包括空格符和制表符）" aria-hidden="true" class="header-anchor">#</a> 删除每行前的空白（包括空格符和制表符）</h3> <h1 id="使所有文本左对齐"><a href="#使所有文本左对齐" aria-hidden="true" class="header-anchor">#</a> 使所有文本左对齐</h1> <p>awk '{sub(/^[ \t]+/, &quot;&quot;)};1'</p> <h3 id="删除每行结尾的空白（包括空格符和制表符）"><a href="#删除每行结尾的空白（包括空格符和制表符）" aria-hidden="true" class="header-anchor">#</a> 删除每行结尾的空白（包括空格符和制表符）</h3> <p>awk '{sub(/[ \t]+$/, &quot;&quot;)};1'</p> <h3 id="删除每行开头和结尾的所有空白（包括空格符和制表符）"><a href="#删除每行开头和结尾的所有空白（包括空格符和制表符）" aria-hidden="true" class="header-anchor">#</a> 删除每行开头和结尾的所有空白（包括空格符和制表符）</h3> <p>awk '{gsub(/^[ \t]+|[ \t]+$/,&quot;&quot;)};1'<br>
awk '{$1=$1};1'           # 每列之间的空白也被删除</p> <h3 id="在每一行开头处插入5个空格-（做整页的左位移）"><a href="#在每一行开头处插入5个空格-（做整页的左位移）" aria-hidden="true" class="header-anchor">#</a> 在每一行开头处插入5个空格 （做整页的左位移）</h3> <p>awk '{sub(/^/, &quot;     &quot;)};1'</p> <h3 id="用79个字符为宽度，将全部文本右对齐"><a href="#用79个字符为宽度，将全部文本右对齐" aria-hidden="true" class="header-anchor">#</a> 用79个字符为宽度，将全部文本右对齐</h3> <p>awk '{printf &quot;%79s\n&quot;, $0}' file*</p> <h3 id="用79个字符为宽度，将全部文本居中对齐"><a href="#用79个字符为宽度，将全部文本居中对齐" aria-hidden="true" class="header-anchor">#</a> 用79个字符为宽度，将全部文本居中对齐</h3> <p>awk '{l=length();s=int((79-l)/2); printf &quot;%&quot;(s+l)&quot;s\n&quot;,$0}' file*</p> <h3 id="每行用-bar-查找替换-foo"><a href="#每行用-bar-查找替换-foo" aria-hidden="true" class="header-anchor">#</a> 每行用 &quot;bar&quot; 查找替换 &quot;foo&quot;</h3> <p>awk '{sub(/foo/,&quot;bar&quot;)}; 1'           # 仅仅替换第一个找到的&quot;foo&quot;<br>
gawk '{$0=gensub(/foo/,&quot;bar&quot;,4)}; 1'  # 仅仅替换第四个找到的&quot;foo&quot;<br>
awk '{gsub(/foo/,&quot;bar&quot;)}; 1'          # 全部替换</p> <h3 id="在包含-baz-的行里，将-foo-替换为-bar"><a href="#在包含-baz-的行里，将-foo-替换为-bar" aria-hidden="true" class="header-anchor">#</a> 在包含 &quot;baz&quot; 的行里，将 &quot;foo&quot; 替换为 &quot;bar&quot;</h3> <p>awk '/baz/{gsub(/foo/, &quot;bar&quot;)}; 1'</p> <h3 id="在不包含-baz-的行里，将-foo-替换为-bar"><a href="#在不包含-baz-的行里，将-foo-替换为-bar" aria-hidden="true" class="header-anchor">#</a> 在不包含 &quot;baz&quot; 的行里，将 &quot;foo&quot; 替换为 &quot;bar&quot;</h3> <p>awk '!/baz/{gsub(/foo/, &quot;bar&quot;)}; 1'</p> <h3 id="将-scarlet-或者-ruby-或者-puce-替换为-red"><a href="#将-scarlet-或者-ruby-或者-puce-替换为-red" aria-hidden="true" class="header-anchor">#</a> 将 &quot;scarlet&quot; 或者 &quot;ruby&quot; 或者 &quot;puce&quot; 替换为 &quot;red&quot;</h3> <p>awk '{gsub(/scarlet|ruby|puce/, &quot;red&quot;)}; 1'</p> <h3 id="倒排文本-（模拟-tac-）"><a href="#倒排文本-（模拟-tac-）" aria-hidden="true" class="header-anchor">#</a> 倒排文本 （模拟 &quot;tac&quot;）</h3> <p>awk '{a[i++]=$0} END {for (j=i-1; j&gt;=0;) print a[j--] }' file*</p> <h3 id="如果一行结尾为反斜线符，将下一行接到这行后面"><a href="#如果一行结尾为反斜线符，将下一行接到这行后面" aria-hidden="true" class="header-anchor">#</a> 如果一行结尾为反斜线符，将下一行接到这行后面</h3> <h1 id="（如果有连续多行后面带反斜线符，将会失败）"><a href="#（如果有连续多行后面带反斜线符，将会失败）" aria-hidden="true" class="header-anchor">#</a> （如果有连续多行后面带反斜线符，将会失败）</h1> <p>awk '/\/ {sub(/\\/,&quot;&quot;); getline t; print $0 t; next}; 1' file*</p> <h3 id="排序并打印所有登录用户的姓名"><a href="#排序并打印所有登录用户的姓名" aria-hidden="true" class="header-anchor">#</a> 排序并打印所有登录用户的姓名</h3> <p>awk -F &quot;:&quot; '{ print $1 | &quot;sort&quot; }' /etc/passwd</p> <h3 id="以相反的顺序打印出每行的前两列"><a href="#以相反的顺序打印出每行的前两列" aria-hidden="true" class="header-anchor">#</a> 以相反的顺序打印出每行的前两列</h3> <p>awk '{print $2, $1}' file</p> <h3 id="调换前两列的位置"><a href="#调换前两列的位置" aria-hidden="true" class="header-anchor">#</a> 调换前两列的位置</h3> <p>awk '{temp = $1; $1 = $2; $2 = temp}' file</p> <h3 id="打印每行，并删除第二列"><a href="#打印每行，并删除第二列" aria-hidden="true" class="header-anchor">#</a> 打印每行，并删除第二列</h3> <p>awk '{ $2 = &quot;&quot;; print }'</p> <h3 id="倒置每行并打印"><a href="#倒置每行并打印" aria-hidden="true" class="header-anchor">#</a> 倒置每行并打印</h3> <p>awk '{for (i=NF; i&gt;0; i--) printf(&quot;%s &quot;,i);printf (&quot;\n&quot;)}' file</p> <h3 id="用逗号链接每5行"><a href="#用逗号链接每5行" aria-hidden="true" class="header-anchor">#</a> 用逗号链接每5行</h3> <p>awk 'ORS=NR%5?&quot;,&quot;:&quot;\n&quot;' file</p> <h2 id="择性的打印某些行："><a href="#择性的打印某些行：" aria-hidden="true" class="header-anchor">#</a> 择性的打印某些行：</h2> <h3 id="打印文件的前十行-（模拟-head-）"><a href="#打印文件的前十行-（模拟-head-）" aria-hidden="true" class="header-anchor">#</a> 打印文件的前十行 （模拟 &quot;head&quot;）</h3> <p>awk 'NR &lt; 11'</p> <h3 id="打印文件的第一行-（模拟-head-1-）"><a href="#打印文件的第一行-（模拟-head-1-）" aria-hidden="true" class="header-anchor">#</a> 打印文件的第一行 （模拟 &quot;head -1&quot;）</h3> <p>awk 'NR&gt;1{exit};1'</p> <h3 id="打印文件的最后两行-（模拟-tail-2-）"><a href="#打印文件的最后两行-（模拟-tail-2-）" aria-hidden="true" class="header-anchor">#</a> 打印文件的最后两行 （模拟 &quot;tail -2&quot;）</h3> <p>awk '{y=x &quot;\n&quot; $0; x=$0};END{print y}'</p> <h3 id="打印文件的最后一行-（模拟-tail-1-）"><a href="#打印文件的最后一行-（模拟-tail-1-）" aria-hidden="true" class="header-anchor">#</a> 打印文件的最后一行 （模拟 &quot;tail -1&quot;）</h3> <p>awk 'END{print}'</p> <p>###打印匹配正则表达式的行 （模拟 &quot;grep&quot;）<br>
awk '/regex/'</p> <h3 id="打印不匹配正则表达式的行-（模拟-grep-v-）"><a href="#打印不匹配正则表达式的行-（模拟-grep-v-）" aria-hidden="true" class="header-anchor">#</a> 打印不匹配正则表达式的行 （模拟 &quot;grep -v&quot;）</h3> <p>awk '!/regex/'</p> <h3 id="打印第5列等于-abc123-的行"><a href="#打印第5列等于-abc123-的行" aria-hidden="true" class="header-anchor">#</a> 打印第5列等于&quot;abc123&quot;的行</h3> <p>awk '$5 == &quot;abc123&quot;'</p> <h3 id="打印第5列不等于-abc123-的行"><a href="#打印第5列不等于-abc123-的行" aria-hidden="true" class="header-anchor">#</a> 打印第5列不等于&quot;abc123&quot;的行</h3> <h1 id="这个同样可以用于打印少于5列的行"><a href="#这个同样可以用于打印少于5列的行" aria-hidden="true" class="header-anchor">#</a> 这个同样可以用于打印少于5列的行</h1> <p>awk '$5 != &quot;abc123&quot;'<br>
awk '!($5 == &quot;abc123&quot;)'</p> <h3 id="用正则匹配某一列"><a href="#用正则匹配某一列" aria-hidden="true" class="header-anchor">#</a> 用正则匹配某一列</h3> <p>awk '$7  ~ /^[a-f]/'    # 打印第7列匹配的行<br>
awk '$7 !~ /^[a-f]/'    # 打印第7列不匹配的行</p> <h3 id="打印匹配正则表达式的前一行，但是不打印当前行"><a href="#打印匹配正则表达式的前一行，但是不打印当前行" aria-hidden="true" class="header-anchor">#</a> 打印匹配正则表达式的前一行，但是不打印当前行</h3> <p>awk '/regex/{print x};{x=$0}'<br>
awk '/regex/{print (x==&quot;&quot; ? &quot;match on line 1&quot; : x)};{x=$0}'</p> <h3 id="打印匹配正则表达式的后一行，但是不打印当前行"><a href="#打印匹配正则表达式的后一行，但是不打印当前行" aria-hidden="true" class="header-anchor">#</a> 打印匹配正则表达式的后一行，但是不打印当前行</h3> <p>awk '/regex/{getline;print}'</p> <h3 id="以任何顺序查找包含-aaa、bbb-和-ccc-的行"><a href="#以任何顺序查找包含-aaa、bbb-和-ccc-的行" aria-hidden="true" class="header-anchor">#</a> 以任何顺序查找包含 AAA、BBB 和 CCC 的行</h3> <p>awk '/AAA/; /BBB/; /CCC/'</p> <h3 id="以指定顺序查找包含-aaa、bbb-和-ccc-的行"><a href="#以指定顺序查找包含-aaa、bbb-和-ccc-的行" aria-hidden="true" class="header-anchor">#</a> 以指定顺序查找包含 AAA、BBB 和 CCC 的行</h3> <p>awk '/AAA.*BBB.*CCC/'</p> <h3 id="打印长度大于64个字节的行"><a href="#打印长度大于64个字节的行" aria-hidden="true" class="header-anchor">#</a> 打印长度大于64个字节的行</h3> <p>awk 'length &gt; 64'</p> <h3 id="打印长度小于64个字节的行"><a href="#打印长度小于64个字节的行" aria-hidden="true" class="header-anchor">#</a> 打印长度小于64个字节的行</h3> <p>awk 'length &lt; 64'</p> <h3 id="打印从匹配正则起到文件末尾的内容"><a href="#打印从匹配正则起到文件末尾的内容" aria-hidden="true" class="header-anchor">#</a> 打印从匹配正则起到文件末尾的内容</h3> <p>awk '/regex/,0'<br>
awk '/regex/,EOF'</p> <h3 id="打印指定行之间的内容-（8-12行-包括第8和第12行）"><a href="#打印指定行之间的内容-（8-12行-包括第8和第12行）" aria-hidden="true" class="header-anchor">#</a> 打印指定行之间的内容 （8-12行, 包括第8和第12行）</h3> <p>awk 'NR==8,NR==12'</p> <h3 id="打印第52行"><a href="#打印第52行" aria-hidden="true" class="header-anchor">#</a> 打印第52行</h3> <p>awk 'NR==52'<br>
awk 'NR==52 {print;exit}'          # 对于大文件更有效率</p> <h3 id="打印两个正则匹配间的内容-（包括正则的内容）"><a href="#打印两个正则匹配间的内容-（包括正则的内容）" aria-hidden="true" class="header-anchor">#</a> 打印两个正则匹配间的内容 （包括正则的内容）</h3> <p>awk '/Iowa/,/Montana/'             # 大小写敏感</p> <h2 id="选择性的删除某些行："><a href="#选择性的删除某些行：" aria-hidden="true" class="header-anchor">#</a> 选择性的删除某些行：</h2> <h3 id="删除所有空白行-（类似于-grep-）"><a href="#删除所有空白行-（类似于-grep-）" aria-hidden="true" class="header-anchor">#</a> 删除所有空白行 （类似于 &quot;grep '.' &quot;）</h3> <p>awk NF<br>
awk '/./'</p> <h3 id="删除重复连续的行-（模拟-uniq-）"><a href="#删除重复连续的行-（模拟-uniq-）" aria-hidden="true" class="header-anchor">#</a> 删除重复连续的行 （模拟 &quot;uniq&quot;）</h3> <p>awk 'a !~ $0; {a=$0}'</p> <h3 id="删除重复的、非连续的行"><a href="#删除重复的、非连续的行" aria-hidden="true" class="header-anchor">#</a> 删除重复的、非连续的行</h3> <p>awk '! a[$0]++'                     # 最简练<br>
awk '!($0 in a) {a[$0];print}'      # 最有效</p> <h3 id="提取日志中的手机号并且统计"><a href="#提取日志中的手机号并且统计" aria-hidden="true" class="header-anchor">#</a> 提取日志中的手机号并且统计</h3> <p>awk -F &quot;&amp;&quot; '/userCode=/{print substr($4,10,21)}' localhost_access_log.2020-06-*.txt |sort | uniq -c  &gt; mobile.txt</p> <h2 id="command-reference"><a href="#command-reference" aria-hidden="true" class="header-anchor">#</a> Command Reference</h2> <h3 id="basics-i"><a href="#basics-i" aria-hidden="true" class="header-anchor">#</a> Basics I</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>$1</td> <td>Reference first column</td></tr> <tr><td>awk '/pattern/ {action}' file</td> <td>Execute action for matched pattern 'pattern' on file 'file'</td></tr> <tr><td>;</td> <td>Char to separate two actions</td></tr> <tr><td>print</td> <td>Print current record line</td></tr> <tr><td>$0</td> <td>Reference current record line</td></tr></tbody></table> <h3 id="variables-i"><a href="#variables-i" aria-hidden="true" class="header-anchor">#</a> Variables I</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>$2</td> <td>Reference second column</td></tr> <tr><td>FS</td> <td>Field separator of input file (default whitespace)</td></tr> <tr><td>NF</td> <td>Number of fields in current record</td></tr> <tr><td>NR</td> <td>Line number of the current record</td></tr></tbody></table> <h3 id="basics-ii"><a href="#basics-ii" aria-hidden="true" class="header-anchor">#</a> Basics II</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>^</td> <td>Match beginning of field</td></tr> <tr><td>~</td> <td>Match opterator</td></tr> <tr><td>!~</td> <td>Do not match operator</td></tr> <tr><td>-F</td> <td>Command line option to specify input field delimiter</td></tr> <tr><td>BEGIN</td> <td>Denotes block executed once at start</td></tr> <tr><td>END</td> <td>Denotes block executed once at end</td></tr> <tr><td>str1 str2</td> <td>Concat str1 and str2</td></tr></tbody></table> <h3 id="one-line-exercises-i"><a href="#one-line-exercises-i" aria-hidden="true" class="header-anchor">#</a> One-Line Exercises I</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>awk '{print $1}' file</td> <td>Print first field for each record in file</td></tr> <tr><td>awk '/regex/' file</td> <td>Print only lines that match regex in file</td></tr> <tr><td>awk '!/regex/' file</td> <td>Print only lines that do not match regex in file</td></tr> <tr><td>awk '$2 == &quot;foo&quot;' file</td> <td>Print any line where field 2 is equal to &quot;foo&quot; in file</td></tr> <tr><td>awk '$2 != &quot;foo&quot;' file</td> <td>Print lines where field 2 is NOT equal to &quot;foo&quot; in file</td></tr> <tr><td>awk '$1 ~ /regex/' file</td> <td>Print line if field 1 matches regex in file</td></tr> <tr><td>awk '$1 !~ /regex/' file</td> <td>Print line if field 1 does NOT match regex in file</td></tr></tbody></table> <h3 id="variables-ii"><a href="#variables-ii" aria-hidden="true" class="header-anchor">#</a> Variables II</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>FILENAME</td> <td>Reference current input file</td></tr> <tr><td>FNR</td> <td>Reference number of the current record relative to current input file</td></tr> <tr><td>OFS</td> <td>Field separator of the outputted data (default whitespace)</td></tr> <tr><td>ORS</td> <td>Record separator of the outputted data (default newline)</td></tr> <tr><td>RS</td> <td>Record separator of input file (default newline)</td></tr></tbody></table> <h3 id="variables-iii"><a href="#variables-iii" aria-hidden="true" class="header-anchor">#</a> Variables III</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>CONVFMT</td> <td>Conversion format used when converting numbers (default %.6g)</td></tr> <tr><td>SUBSEP</td> <td>Separates multiple subscripts (default 034)</td></tr> <tr><td>OFMT</td> <td>Output format for numbers (default %.6g)</td></tr> <tr><td>ARGC</td> <td>Argument count, assignable</td></tr> <tr><td>ARGV</td> <td>Argument array, assignable</td></tr> <tr><td>ENVIRON</td> <td>Array of environment variables</td></tr></tbody></table> <h3 id="functions-i"><a href="#functions-i" aria-hidden="true" class="header-anchor">#</a> Functions I</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>index(s,t)</td> <td>Position in string s where string t occurs, 0 if not found</td></tr> <tr><td>length(s)</td> <td>Length of string s (or $0 if no arg)</td></tr> <tr><td>rand</td> <td>Random number between 0 and 1</td></tr> <tr><td>substr(s,index,len)</td> <td>Return len-char substring of s that begins at index (counted from 1)</td></tr> <tr><td>srand</td> <td>Set seed for rand and return previous seed</td></tr> <tr><td>int(x)</td> <td>Truncate x to integer value</td></tr></tbody></table> <h3 id="functions-ii"><a href="#functions-ii" aria-hidden="true" class="header-anchor">#</a> Functions II</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>split(s,a,fs)</td> <td>Split string s into array a split by fs, returning length of a</td></tr> <tr><td>match(s,r)</td> <td>Position in string s where regex r occurs, or 0 if not found</td></tr> <tr><td>sub(r,t,s)</td> <td>Substitute t for first occurrence of regex r in string s (or $0 if s not given)</td></tr> <tr><td>gsub(r,t,s)</td> <td>Substitute t for all occurrences of regex r in string s</td></tr></tbody></table> <h3 id="functions-iii"><a href="#functions-iii" aria-hidden="true" class="header-anchor">#</a> Functions III</h3> <table><thead><tr><th>args</th> <th>description</th></tr></thead> <tbody><tr><td>awk 'NR!=1{print $1}' file</td> <td>Print first field for each record in file excluding the first record</td></tr> <tr><td>awk 'END{print NR}' file</td> <td>Count lines in file</td></tr> <tr><td>awk '/foo/{n++}; END {print n+0}' file</td> <td>Print total number of lines that contain foo</td></tr> <tr><td>awk '{total=total+NF};END{print total}' file</td> <td>Print total number of fields in all lines</td></tr> <tr><td>awk '/regex/{getline;print}' file</td> <td>Print line immediately after regex, but not line containing regex in file</td></tr> <tr><td>awk 'length &gt; 32' file</td> <td>Print lines with more than 32 characters in file</td></tr> <tr><td>awk 'NR==12' file</td> <td>Print line number 12 of file</td></tr></tbody></table></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/other/oss.html" class="prev">
          阿里OSS使用技巧
        </a></span> <span class="next"><a href="/other/redissearch.html">
          Redis search with Lua
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/41.1921a30c.js" defer></script><script src="/assets/js/app.7863e8ac.js" defer></script>
  </body>
</html>
