(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{271:function(e,t,n){e.exports=n.p+"assets/img/direct-illustr.94866926.gif"},272:function(e,t,n){e.exports=n.p+"assets/img/direct-vm-seda-example.18b5add1.png"},428:function(e,t,n){"use strict";n.r(t);var s=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"guide-to-camel’s-seda-direct-and-vm-components-fw"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#guide-to-camel’s-seda-direct-and-vm-components-fw","aria-hidden":"true"}},[e._v("#")]),e._v(" Guide to Camel’s SEDA, Direct and VM components(FW)")]),e._v(" "),s("p",[e._v("(from ：https://cleverbuilder.com/articles/camel-direct-vm-seda/, author:Tom Donohue)")]),e._v(" "),s("p",[e._v("When designing your Camel routes, you may sometimes want a route to have multiple inputs. Maybe you want to receive messages from a web service and from a JMS queue.")]),e._v(" "),s("p",[e._v("You can’t have multiple from() methods in the same route, so how can you have multiple entry points to the same route?")]),e._v(" "),s("p",[e._v("Similarly, you might want to reuse the same Camel message processing logic in multiple places, so how do you avoid duplicating code?")]),e._v(" "),s("p",[e._v("The answer to both these questions is to join your routes together, using Camel’s in-memory messaging components: Direct, Direct-VM, VM and SEDA.")]),e._v(" "),s("p",[e._v("In this article I’ll explain each of these components, how they differ, and how you can use them to make your routes more modular and awesome.")]),e._v(" "),s("h2",{attrs:{id:"first…an-example-scenario"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#first…an-example-scenario","aria-hidden":"true"}},[e._v("#")]),e._v(" First…an example scenario")]),e._v(" "),s("p",[e._v("First I’m going to start with an example.")]),e._v(" "),s("p",[e._v("I have defined a route that validates an incoming order, by passing a message to some underlying system. My orders initially arrive through JMS messages.")]),e._v(" "),s("p",[s("img",{attrs:{src:n(272),alt:"images"}})]),e._v(" "),s("p",[e._v("But what happens when orders start coming from new sources - such as a file upload, or a web service call?")]),e._v(" "),s("p",[e._v("To avoid having to repeat the same route code, Camel has features built-in which allow routes to have multiple inputs, by using a range of joining components to glue these routes together.")]),e._v(" "),s("p",[e._v("So how does it work? Camel glues endpoints together using the components Direct, VM and SEDA.")]),e._v(" "),s("p",[e._v("These components join your Camel routes together in different ways. They are collectively known as Camel’s in-memory messaging components, because they allow messages to be passed between routes, while the message stays in memory at all times. This is a really important detail, which I’ll touch on again later.")]),e._v(" "),s("p",[e._v("But for now, let’s now look at each of these components to see how they differ, and where you might use them.")]),e._v(" "),s("h2",{attrs:{id:"direct-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#direct-component","aria-hidden":"true"}},[e._v("#")]),e._v(" Direct component")]),e._v(" "),s("p",[e._v("This has to be one of the most frequently-asked questions by Camel beginners:")]),e._v(" "),s("blockquote",[s("blockquote",[s("p",[e._v("What does “direct” mean in a route?")])])]),e._v(" "),s("p",[s("img",{attrs:{src:n(271),alt:"images"}})]),e._v(" "),s("p",[e._v("You’ve probably seen the code direct:... in so many Camel tutorials on the web. But what does direct actually do?")]),e._v(" "),s("p",[e._v("direct is one of the most simple ways of linking your routes together. When it’s used in a from() definition, it creates a synchronous endpoint that can be invoked by other Camel routes. For example, this code which starts with from(direct):")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token function"}},[e._v("from")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"direct:yourname"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("…will create a Direct endpoint called yourname. That same endpoint can then be invoked in another to() statement somewhere else, like this:")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("to")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"direct:yourname"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v("  "),s("span",{attrs:{class:"token comment"}},[e._v("// sends the message to the direct:yourname endpoint")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v('Apache Camel’s Direct component joins routes in a synchronous way. This means that when one route sends a message to another direct endpoint using to("direct:myroute"), the route myroute will be executed in the same thread as the first route, and a response message will be returned.')]),e._v(" "),s("p",[e._v("In examples, it’s often used because it provides a simple entry point into a route, without having to expose a web service, or otherwise rely on an external interface.")]),e._v(" "),s("h3",{attrs:{id:"example-using-the-direct-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-using-the-direct-component","aria-hidden":"true"}},[e._v("#")]),e._v(" Example: using the Direct component")]),e._v(" "),s("p",[e._v("Example: using the Direct component")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token function"}},[e._v("from")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"file:/home/files/in"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v("       "),s("span",{attrs:{class:"token comment"}},[e._v("// receive a file")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("to")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"direct:processTheFile"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),s("span",{attrs:{class:"token comment"}},[e._v("// send to direct endpoint")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("to")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"Body is now ${body}"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v("   "),s("span",{attrs:{class:"token comment"}},[e._v("// will print 'Eggs!'")]),e._v("\n\n"),s("span",{attrs:{class:"token comment"}},[e._v("// meanwhile...    ")]),e._v("\n"),s("span",{attrs:{class:"token function"}},[e._v("from")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"direct:processTheFile"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v("     "),s("span",{attrs:{class:"token comment"}},[e._v("// receive from direct endpoint")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("setBody")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"Eggs!"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v("            "),s("span",{attrs:{class:"token comment"}},[e._v("// modify the message body")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("This very simple example receives files using Camel’s File component. Each file processed is passed, as an Exchange, to the direct endpoint processTheFile.")]),e._v(" "),s("p",[e._v("Separately, we have defined the processTheFile endpoint as the start component for a route which modifies the message body. Once this is done, the new message is returned back to the calling route. All of this happens synchronously, within the same thread.")]),e._v(" "),s("p",[e._v("The simplicity of Direct comes with some drawbacks.")]),e._v(" "),s("p",[e._v("Direct endpoints can only be accessed by other routes that are running in the same CamelContext and in the same JVM. This means that you cannot access a Direct endpoint from another CamelContext. Remember the CamelContext is the container where your Camel routes are created and booted up.")]),e._v(" "),s("p",[e._v("So what happens if you want to access a route in another CamelContext? You use the next component, Direct-VM.")]),e._v(" "),s("h2",{attrs:{id:"direct-vm-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#direct-vm-component","aria-hidden":"true"}},[e._v("#")]),e._v(" Direct-VM component")]),e._v(" "),s("p",[e._v("Direct-VM is a component that allows you to synchronously call another endpoint in the same JVM, even if it’s in a different CamelContext.")]),e._v(" "),s("p",[e._v("When used as a start component, Direct-VM exposes that route as an endpoint which can be invoked synchronously from another route.")]),e._v(" "),s("p",[e._v("The difference with the Direct-VM component is that direct-vm endpoints can be seen from other Camel Contexts, as long as they share the same Java Virtual Machine (JVM).")]),e._v(" "),s("h3",{attrs:{id:"example-using-the-direct-vm-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-using-the-direct-vm-component","aria-hidden":"true"}},[e._v("#")]),e._v(" Example: using the Direct-VM component")]),e._v(" "),s("p",[e._v("If we wanted to show off the Direct-VM component, we could define a route in Application A:")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token function"}},[e._v("from")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"file:src/files/input"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("to")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"direct-vm:process-file"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{attrs:{class:"token comment"}},[e._v("// invoke the direct-vm endpoint")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Which would call this Direct endpoint, located in Application B…:")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token function"}},[e._v("from")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"direct-vm:process-file"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v("    "),s("span",{attrs:{class:"token comment"}},[e._v("// receive from direct-vm endpoint")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("to")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"log:samplelog"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v("         "),s("span",{attrs:{class:"token comment"}},[e._v("// log the message")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("As long as both of these applications are running in the same JVM – for example, using an application container, like Apache Karaf, Wildfly or even different CamelContexts in the same Spring Boot application – then Application A will be able to call the direct-vm endpoint in Application B.")]),e._v(" "),s("p",[e._v("This opens up possibilities of linking routes together that were not developed in the same CamelContext. For example, you might use this component if you have different CamelContexts deployed in one container - such as when you’re deploying into JBoss Fuse or Talend ESB.")]),e._v(" "),s("h2",{attrs:{id:"seda-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#seda-component","aria-hidden":"true"}},[e._v("#")]),e._v(" SEDA component")]),e._v(" "),s("p",[e._v("Camel’s SEDA component allows you to join routes together using a simple queue.")]),e._v(" "),s("p",[e._v("In a Camel route, when a message is sent to a SEDA endpoint, it is stored in a basic in-memory queue, and control is returned back to the calling route immediately.")]),e._v(" "),s("p",[e._v("Then, independently, a SEDA consumer picks up the message from the queue, and begins processing it.")]),e._v(" "),s("h3",{attrs:{id:"example-using-the-seda-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-using-the-seda-component","aria-hidden":"true"}},[e._v("#")]),e._v(" Example: Using the SEDA component")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[e._v("\n"),s("span",{attrs:{class:"token function"}},[e._v("rest")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"/orders"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("post")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v("                "),s("span",{attrs:{class:"token comment"}},[e._v("// receive an order via REST")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("to")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"seda:processOrder"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v("         "),s("span",{attrs:{class:"token comment"}},[e._v("// send to the seda queue")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("setBody")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"Thanks for ordering!"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),s("span",{attrs:{class:"token comment"}},[e._v("// create a REST response")]),e._v("\n    \n"),s("span",{attrs:{class:"token function"}},[e._v("from")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"seda:processOrder"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v("             "),s("span",{attrs:{class:"token comment"}},[e._v("// receive from the seda queue")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("log")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"Processing an order..."')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{attrs:{class:"token function"}},[e._v("to")]),s("span",{attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{attrs:{class:"token string"}},[e._v('"file:orders/out"')]),s("span",{attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v("  \n\t\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br")])]),s("p",[e._v("In the example above, messages will be received via a REST service and published to the SEDA endpoint. Messages arrive at the processOrder SEDA endpoint and are processed, where they are written to a location on disk, using the file: component.")]),e._v(" "),s("p",[e._v("SEDA does this by creating its own buffer which is used to store the incoming messages. Out of the box, SEDA creates a pool of threads to process incoming messages, meaning that several messages can be processed at once, making it potentially more performant.")]),e._v(" "),s("p",[e._v("In this way, SEDA can be thought of as a simple replacement for JMS queues. It provides queue-like functionality, but without the overhead of running an external message broker like ActiveMQ.")]),e._v(" "),s("p",[e._v("Remember that Camel publishes messages to a SEDA endpoint asynchronously.")]),e._v(" "),s("p",[e._v("You can only access SEDA endpoints that are located in the same CamelContext. So what happens if you want to send a message to a SEDA queue in another CamelContext? You use the next component, VM.")]),e._v(" "),s("p",[e._v("Guide to Camel’s SEDA, Direct and VM components\nUpdated: May 22, 2018\nGuide to Camel’s SEDA, Direct and VM components")]),e._v(" "),s("p",[e._v("When designing your Camel routes, you may sometimes want a route to have multiple inputs. Maybe you want to receive messages from a web service and from a JMS queue.")]),e._v(" "),s("p",[e._v("You can’t have multiple from() methods in the same route, so how can you have multiple entry points to the same route?")]),e._v(" "),s("p",[e._v("Similarly, you might want to reuse the same Camel message processing logic in multiple places, so how do you avoid duplicating code?")]),e._v(" "),s("p",[e._v("The answer to both these questions is to join your routes together, using Camel’s in-memory messaging components: Direct, Direct-VM, VM and SEDA.")]),e._v(" "),s("p",[e._v("In this article I’ll explain each of these components, how they differ, and how you can use them to make your routes more modular and awesome.")]),e._v(" "),s("p",[e._v("ON THIS PAGE\nFIRST…AN EXAMPLE SCENARIO\nDIRECT COMPONENT\nEXAMPLE: USING THE DIRECT COMPONENT\nDIRECT-VM COMPONENT\nEXAMPLE: USING THE DIRECT-VM COMPONENT\nSEDA COMPONENT\nEXAMPLE: USING THE SEDA COMPONENT\nVM COMPONENT\nDRAWBACKS OF SEDA AND VM\nSUMMARY AND BEST PRACTICES\nCOMPARISON OF DIRECT, SEDA, VM AND DIRECT-VM\nFirst…an example scenario\nFirst I’m going to start with an example.")]),e._v(" "),s("p",[e._v("I have defined a route that validates an incoming order, by passing a message to some underlying system. My orders initially arrive through JMS messages.")]),e._v(" "),s("p",[e._v("Joining camel routes example scenario")]),e._v(" "),s("p",[e._v("But what happens when orders start coming from new sources - such as a file upload, or a web service call?")]),e._v(" "),s("p",[e._v("To avoid having to repeat the same route code, Camel has features built-in which allow routes to have multiple inputs, by using a range of joining components to glue these routes together.")]),e._v(" "),s("p",[e._v("So how does it work? Camel glues endpoints together using the components Direct, VM and SEDA.")]),e._v(" "),s("p",[e._v("These components join your Camel routes together in different ways. They are collectively known as Camel’s in-memory messaging components, because they allow messages to be passed between routes, while the message stays in memory at all times. This is a really important detail, which I’ll touch on again later.")]),e._v(" "),s("p",[e._v("But for now, let’s now look at each of these components to see how they differ, and where you might use them.")]),e._v(" "),s("p",[e._v("Direct component\nThis has to be one of the most frequently-asked questions by Camel beginners:")]),e._v(" "),s("p",[e._v("What does “direct” mean in a route?")]),e._v(" "),s("p",[e._v("The Direct component in Camel")]),e._v(" "),s("p",[e._v("You’ve probably seen the code direct:... in so many Camel tutorials on the web. But what does direct actually do?")]),e._v(" "),s("p",[e._v("direct is one of the most simple ways of linking your routes together. When it’s used in a from() definition, it creates a synchronous endpoint that can be invoked by other Camel routes. For example, this code which starts with from(direct):")]),e._v(" "),s("p",[e._v('from("direct:yourname")...\n…will create a Direct endpoint called yourname. That same endpoint can then be invoked in another to() statement somewhere else, like this:')]),e._v(" "),s("p",[e._v('.to("direct:yourname");  // sends the message to the direct:yourname endpoint\nApache Camel’s Direct component joins routes in a synchronous way. This means that when one route sends a message to another direct endpoint using to("direct:myroute"), the route myroute will be executed in the same thread as the first route, and a response message will be returned.')]),e._v(" "),s("p",[e._v("In examples, it’s often used because it provides a simple entry point into a route, without having to expose a web service, or otherwise rely on an external interface.")]),e._v(" "),s("p",[e._v("Example: using the Direct component\nLet’s illustrate the Direct component with an example:")]),e._v(" "),s("p",[e._v('from("file:/home/files/in")       // receive a file\n.to("direct:processTheFile"); // send to direct endpoint\n.to("Body is now ${body}");   // will print \'Eggs!\'')]),e._v(" "),s("p",[e._v("// meanwhile..."),s("br"),e._v('\nfrom("direct:processTheFile")     // receive from direct endpoint\n.setBody("Eggs!");            // modify the message body\nThis very simple example receives files using Camel’s File component. Each file processed is passed, as an Exchange, to the direct endpoint processTheFile.')]),e._v(" "),s("p",[e._v("Separately, we have defined the processTheFile endpoint as the start component for a route which modifies the message body. Once this is done, the new message is returned back to the calling route. All of this happens synchronously, within the same thread.")]),e._v(" "),s("p",[e._v("The simplicity of Direct comes with some drawbacks.")]),e._v(" "),s("p",[e._v("Direct endpoints can only be accessed by other routes that are running in the same CamelContext and in the same JVM. This means that you cannot access a Direct endpoint from another CamelContext. Remember the CamelContext is the container where your Camel routes are created and booted up.")]),e._v(" "),s("p",[e._v("So what happens if you want to access a route in another CamelContext? You use the next component, Direct-VM.")]),e._v(" "),s("p",[e._v("Direct-VM component\nDirect-VM is a component that allows you to synchronously call another endpoint in the same JVM, even if it’s in a different CamelContext.")]),e._v(" "),s("p",[e._v("When used as a start component, Direct-VM exposes that route as an endpoint which can be invoked synchronously from another route.")]),e._v(" "),s("p",[e._v("The difference with the Direct-VM component is that direct-vm endpoints can be seen from other Camel Contexts, as long as they share the same Java Virtual Machine (JVM).")]),e._v(" "),s("p",[e._v("Example: using the Direct-VM component\nIf we wanted to show off the Direct-VM component, we could define a route in Application A:")]),e._v(" "),s("p",[e._v('from("file:src/files/input")\n.to("direct-vm:process-file") // invoke the direct-vm endpoint\nWhich would call this Direct endpoint, located in Application B…:')]),e._v(" "),s("p",[e._v('from("direct-vm:process-file")    // receive from direct-vm endpoint\n.to("log:samplelog");         // log the message\nAs long as both of these applications are running in the same JVM – for example, using an application container, like Apache Karaf, Wildfly or even different CamelContexts in the same Spring Boot application – then Application A will be able to call the direct-vm endpoint in Application B.')]),e._v(" "),s("p",[e._v("This opens up possibilities of linking routes together that were not developed in the same CamelContext. For example, you might use this component if you have different CamelContexts deployed in one container - such as when you’re deploying into JBoss Fuse or Talend ESB.")]),e._v(" "),s("p",[e._v("SEDA component\nCamel’s SEDA component allows you to join routes together using a simple queue.")]),e._v(" "),s("p",[e._v("In a Camel route, when a message is sent to a SEDA endpoint, it is stored in a basic in-memory queue, and control is returned back to the calling route immediately.")]),e._v(" "),s("p",[e._v("Then, independently, a SEDA consumer picks up the message from the queue, and begins processing it.")]),e._v(" "),s("p",[e._v("Example: Using the SEDA component\nHere’s an example of a SEDA queue in action:")]),e._v(" "),s("p",[e._v('rest("/orders").post()                // receive an order via REST\n.to("seda:processOrder");         // send to the seda queue\n.setBody("Thanks for ordering!"); // create a REST response')]),e._v(" "),s("p",[e._v('from("seda:processOrder")             // receive from the seda queue\n.log("Processing an order...")\n.to("file:orders/out");'),s("br"),e._v("\nIn the example above, messages will be received via a REST service and published to the SEDA endpoint. Messages arrive at the processOrder SEDA endpoint and are processed, where they are written to a location on disk, using the file: component.")]),e._v(" "),s("p",[e._v("SEDA does this by creating its own buffer which is used to store the incoming messages. Out of the box, SEDA creates a pool of threads to process incoming messages, meaning that several messages can be processed at once, making it potentially more performant.")]),e._v(" "),s("p",[e._v("In this way, SEDA can be thought of as a simple replacement for JMS queues. It provides queue-like functionality, but without the overhead of running an external message broker like ActiveMQ.")]),e._v(" "),s("p",[e._v("Remember that Camel publishes messages to a SEDA endpoint asynchronously.")]),e._v(" "),s("p",[e._v("You can only access SEDA endpoints that are located in the same CamelContext. So what happens if you want to send a message to a SEDA queue in another CamelContext? You use the next component, VM.")]),e._v(" "),s("h2",{attrs:{id:"vm-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vm-component","aria-hidden":"true"}},[e._v("#")]),e._v(" VM component")]),e._v(" "),s("p",[e._v("In a similar way to how Direct and Direct-VM are related, VM is a similar component to SEDA.")]),e._v(" "),s("p",[e._v("When used as a start component, SEDA allows a route to be invoked asynchronously from another route.")]),e._v(" "),s("p",[e._v("However the difference between SEDA and VM is that the VM component allows endpoints to be accessed from different Camel Contexts, as long as they are running in the same JVM.")]),e._v(" "),s("p",[e._v("Again, the VM component opens up possibilities of linking routes together that were not developed in the same Camel Context, in an asynchronous manner.")]),e._v(" "),s("h2",{attrs:{id:"guide-to-camel’s-seda-direct-and-vm-components"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#guide-to-camel’s-seda-direct-and-vm-components","aria-hidden":"true"}},[e._v("#")]),e._v(" Guide to Camel’s SEDA, Direct and VM components")]),e._v(" "),s("p",[e._v("Updated: May 22, 2018\nGuide to Camel’s SEDA, Direct and VM components")]),e._v(" "),s("p",[e._v("When designing your Camel routes, you may sometimes want a route to have multiple inputs. Maybe you want to receive messages from a web service and from a JMS queue.")]),e._v(" "),s("p",[e._v("You can’t have multiple from() methods in the same route, so how can you have multiple entry points to the same route?")]),e._v(" "),s("p",[e._v("Similarly, you might want to reuse the same Camel message processing logic in multiple places, so how do you avoid duplicating code?")]),e._v(" "),s("p",[e._v("The answer to both these questions is to join your routes together, using Camel’s in-memory messaging components: Direct, Direct-VM, VM and SEDA.")]),e._v(" "),s("p",[e._v("In this article I’ll explain each of these components, how they differ, and how you can use them to make your routes more modular and awesome.")]),e._v(" "),s("p",[e._v("ON THIS PAGE\nFIRST…AN EXAMPLE SCENARIO\nDIRECT COMPONENT\nEXAMPLE: USING THE DIRECT COMPONENT\nDIRECT-VM COMPONENT\nEXAMPLE: USING THE DIRECT-VM COMPONENT\nSEDA COMPONENT\nEXAMPLE: USING THE SEDA COMPONENT\nVM COMPONENT\nDRAWBACKS OF SEDA AND VM\nSUMMARY AND BEST PRACTICES\nCOMPARISON OF DIRECT, SEDA, VM AND DIRECT-VM\nFirst…an example scenario\nFirst I’m going to start with an example.")]),e._v(" "),s("p",[e._v("I have defined a route that validates an incoming order, by passing a message to some underlying system. My orders initially arrive through JMS messages.")]),e._v(" "),s("p",[e._v("Joining camel routes example scenario")]),e._v(" "),s("p",[e._v("But what happens when orders start coming from new sources - such as a file upload, or a web service call?")]),e._v(" "),s("p",[e._v("To avoid having to repeat the same route code, Camel has features built-in which allow routes to have multiple inputs, by using a range of joining components to glue these routes together.")]),e._v(" "),s("p",[e._v("So how does it work? Camel glues endpoints together using the components Direct, VM and SEDA.")]),e._v(" "),s("p",[e._v("These components join your Camel routes together in different ways. They are collectively known as Camel’s in-memory messaging components, because they allow messages to be passed between routes, while the message stays in memory at all times. This is a really important detail, which I’ll touch on again later.")]),e._v(" "),s("p",[e._v("But for now, let’s now look at each of these components to see how they differ, and where you might use them.")]),e._v(" "),s("p",[e._v("Direct component\nThis has to be one of the most frequently-asked questions by Camel beginners:")]),e._v(" "),s("p",[e._v("What does “direct” mean in a route?")]),e._v(" "),s("p",[e._v("The Direct component in Camel")]),e._v(" "),s("p",[e._v("You’ve probably seen the code direct:... in so many Camel tutorials on the web. But what does direct actually do?")]),e._v(" "),s("p",[e._v("direct is one of the most simple ways of linking your routes together. When it’s used in a from() definition, it creates a synchronous endpoint that can be invoked by other Camel routes. For example, this code which starts with from(direct):")]),e._v(" "),s("p",[e._v('from("direct:yourname")...\n…will create a Direct endpoint called yourname. That same endpoint can then be invoked in another to() statement somewhere else, like this:')]),e._v(" "),s("p",[e._v('.to("direct:yourname");  // sends the message to the direct:yourname endpoint\nApache Camel’s Direct component joins routes in a synchronous way. This means that when one route sends a message to another direct endpoint using to("direct:myroute"), the route myroute will be executed in the same thread as the first route, and a response message will be returned.')]),e._v(" "),s("p",[e._v("In examples, it’s often used because it provides a simple entry point into a route, without having to expose a web service, or otherwise rely on an external interface.")]),e._v(" "),s("p",[e._v("Example: using the Direct component\nLet’s illustrate the Direct component with an example:")]),e._v(" "),s("p",[e._v('from("file:/home/files/in")       // receive a file\n.to("direct:processTheFile"); // send to direct endpoint\n.to("Body is now ${body}");   // will print \'Eggs!\'')]),e._v(" "),s("p",[e._v("// meanwhile..."),s("br"),e._v('\nfrom("direct:processTheFile")     // receive from direct endpoint\n.setBody("Eggs!");            // modify the message body\nThis very simple example receives files using Camel’s File component. Each file processed is passed, as an Exchange, to the direct endpoint processTheFile.')]),e._v(" "),s("p",[e._v("Separately, we have defined the processTheFile endpoint as the start component for a route which modifies the message body. Once this is done, the new message is returned back to the calling route. All of this happens synchronously, within the same thread.")]),e._v(" "),s("p",[e._v("The simplicity of Direct comes with some drawbacks.")]),e._v(" "),s("p",[e._v("Direct endpoints can only be accessed by other routes that are running in the same CamelContext and in the same JVM. This means that you cannot access a Direct endpoint from another CamelContext. Remember the CamelContext is the container where your Camel routes are created and booted up.")]),e._v(" "),s("p",[e._v("So what happens if you want to access a route in another CamelContext? You use the next component, Direct-VM.")]),e._v(" "),s("p",[e._v("Direct-VM component\nDirect-VM is a component that allows you to synchronously call another endpoint in the same JVM, even if it’s in a different CamelContext.")]),e._v(" "),s("p",[e._v("When used as a start component, Direct-VM exposes that route as an endpoint which can be invoked synchronously from another route.")]),e._v(" "),s("p",[e._v("The difference with the Direct-VM component is that direct-vm endpoints can be seen from other Camel Contexts, as long as they share the same Java Virtual Machine (JVM).")]),e._v(" "),s("p",[e._v("Example: using the Direct-VM component\nIf we wanted to show off the Direct-VM component, we could define a route in Application A:")]),e._v(" "),s("p",[e._v('from("file:src/files/input")\n.to("direct-vm:process-file") // invoke the direct-vm endpoint\nWhich would call this Direct endpoint, located in Application B…:')]),e._v(" "),s("p",[e._v('from("direct-vm:process-file")    // receive from direct-vm endpoint\n.to("log:samplelog");         // log the message\nAs long as both of these applications are running in the same JVM – for example, using an application container, like Apache Karaf, Wildfly or even different CamelContexts in the same Spring Boot application – then Application A will be able to call the direct-vm endpoint in Application B.')]),e._v(" "),s("p",[e._v("This opens up possibilities of linking routes together that were not developed in the same CamelContext. For example, you might use this component if you have different CamelContexts deployed in one container - such as when you’re deploying into JBoss Fuse or Talend ESB.")]),e._v(" "),s("p",[e._v("SEDA component\nCamel’s SEDA component allows you to join routes together using a simple queue.")]),e._v(" "),s("p",[e._v("In a Camel route, when a message is sent to a SEDA endpoint, it is stored in a basic in-memory queue, and control is returned back to the calling route immediately.")]),e._v(" "),s("p",[e._v("Then, independently, a SEDA consumer picks up the message from the queue, and begins processing it.")]),e._v(" "),s("p",[e._v("Example: Using the SEDA component\nHere’s an example of a SEDA queue in action:")]),e._v(" "),s("p",[e._v('rest("/orders").post()                // receive an order via REST\n.to("seda:processOrder");         // send to the seda queue\n.setBody("Thanks for ordering!"); // create a REST response')]),e._v(" "),s("p",[e._v('from("seda:processOrder")             // receive from the seda queue\n.log("Processing an order...")\n.to("file:orders/out");'),s("br"),e._v("\nIn the example above, messages will be received via a REST service and published to the SEDA endpoint. Messages arrive at the processOrder SEDA endpoint and are processed, where they are written to a location on disk, using the file: component.")]),e._v(" "),s("p",[e._v("SEDA does this by creating its own buffer which is used to store the incoming messages. Out of the box, SEDA creates a pool of threads to process incoming messages, meaning that several messages can be processed at once, making it potentially more performant.")]),e._v(" "),s("p",[e._v("In this way, SEDA can be thought of as a simple replacement for JMS queues. It provides queue-like functionality, but without the overhead of running an external message broker like ActiveMQ.")]),e._v(" "),s("p",[e._v("Remember that Camel publishes messages to a SEDA endpoint asynchronously.")]),e._v(" "),s("p",[e._v("You can only access SEDA endpoints that are located in the same CamelContext. So what happens if you want to send a message to a SEDA queue in another CamelContext? You use the next component, VM.")]),e._v(" "),s("p",[e._v("VM component\nIn a similar way to how Direct and Direct-VM are related, VM is a similar component to SEDA.")]),e._v(" "),s("p",[e._v("When used as a start component, SEDA allows a route to be invoked asynchronously from another route.")]),e._v(" "),s("p",[e._v("However the difference between SEDA and VM is that the VM component allows endpoints to be accessed from different Camel Contexts, as long as they are running in the same JVM.")]),e._v(" "),s("p",[e._v("Again, the VM component opens up possibilities of linking routes together that were not developed in the same Camel Context, in an asynchronous manner.")]),e._v(" "),s("h2",{attrs:{id:"drawbacks-of-seda-and-vm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#drawbacks-of-seda-and-vm","aria-hidden":"true"}},[e._v("#")]),e._v(" Drawbacks of SEDA and VM")]),e._v(" "),s("p",[e._v("The biggest drawback of using in-memory messaging like SEDA and VM is that if the application crashes, there’s a big chance you’ll lose all your messages.")]),e._v(" "),s("p",[e._v("This isn’t a major consideration if you’re designing the kind of integrations where it doesn’t matter if the message goes missing.")]),e._v(" "),s("p",[e._v("But think back to the order processing example at the top of this article. If an order gets lost during a server outage, this potentially means lost business. (Uh-oh.)")]),e._v(" "),s("p",[e._v("Have a think about when it’s appropriate to use these in-memory messaging components, and when it might be more appropriate to hand over the message to an external message broker, such as ActiveMQ, for reliability.")]),e._v(" "),s("p",[e._v("There isn’t a hard and fast rule. The right solution always depends on your use case. So when designing integrations using Camel, think about what you’d do if you lost messages. Would it matter? If it would, consider using transactions and persistent messaging to minimise any message loss.")]),e._v(" "),s("h2",{attrs:{id:"summary-and-best-practices"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#summary-and-best-practices","aria-hidden":"true"}},[e._v("#")]),e._v(" Summary and best practices")]),e._v(" "),s("p",[e._v("So now you’ve learned about each component, which should you use, and when?")]),e._v(" "),s("h3",{attrs:{id:"seda-vs-direct"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#seda-vs-direct","aria-hidden":"true"}},[e._v("#")]),e._v(" SEDA vs Direct:")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("For synchronous (request/response) interactions within the same CamelContext, use Direct")])]),e._v(" "),s("li",[s("p",[e._v("For asynchronous (fire-and-forget) processing within the same CamelContext (to process messages in a queue-like fashion), use SEDA")])])]),e._v(" "),s("h3",{attrs:{id:"vm-vs-direct-vm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vm-vs-direct-vm","aria-hidden":"true"}},[e._v("#")]),e._v(" VM vs Direct-VM:")]),e._v(" "),s("ul",[s("li",[e._v("For synchronous (request/response) interactions in another CamelContext but within the same JVM, use Direct-VM")]),e._v(" "),s("li",[e._v("For asynchronous (fire-and-forget) interactions in another CamelContext but within the same JVM, use VM")])]),e._v(" "),s("h3",{attrs:{id:"comparison-of-direct-seda-vm-and-direct-vm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#comparison-of-direct-seda-vm-and-direct-vm","aria-hidden":"true"}},[e._v("#")]),e._v(" Comparison of Direct, SEDA, VM and Direct-VM")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("Component")]),e._v(" "),s("th",[e._v("Type")]),e._v(" "),s("th",[e._v("Within same CamelContext")]),e._v(" "),s("th",[e._v("Within same JVM")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("Direct")]),e._v(" "),s("td",[e._v("Synchronous")]),e._v(" "),s("td",[e._v("Yes")]),e._v(" "),s("td",[e._v("No")])]),e._v(" "),s("tr",[s("td",[e._v("Direct-VM")]),e._v(" "),s("td",[e._v("Synchronous")]),e._v(" "),s("td",[e._v("Yes")]),e._v(" "),s("td",[e._v("Yes")])]),e._v(" "),s("tr",[s("td",[e._v("SEDA")]),e._v(" "),s("td",[e._v("Asynchronous")]),e._v(" "),s("td",[e._v("Yes")]),e._v(" "),s("td",[e._v("No")])]),e._v(" "),s("tr",[s("td",[e._v("VM")]),e._v(" "),s("td",[e._v("Asynchronous")]),e._v(" "),s("td",[e._v("Yes")]),e._v(" "),s("td",[e._v("Yes")])])])])])}],a=n(0),o=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},s,!1,null,null,null);o.options.__file="camel-seda-direct-vm.md";t.default=o.exports}}]);