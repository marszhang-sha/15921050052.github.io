<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AWS IoT | 油腻中年大叔</title>
    <meta name="description" content="你想要的这里都没有，你不想要的这里都有">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    
    <link rel="preload" href="/assets/css/styles.ded2f491.css" as="style"><link rel="preload" href="/assets/js/app.ded2f491.js" as="script"><link rel="preload" href="/assets/js/32.ab10440c.js" as="script"><link rel="prefetch" href="/assets/js/0.eb7108e7.js"><link rel="prefetch" href="/assets/js/1.d8ec4d72.js"><link rel="prefetch" href="/assets/js/2.28f90b8d.js"><link rel="prefetch" href="/assets/js/3.6001361f.js"><link rel="prefetch" href="/assets/js/4.80c27a58.js"><link rel="prefetch" href="/assets/js/5.2e2f809b.js"><link rel="prefetch" href="/assets/js/6.0d0d8441.js"><link rel="prefetch" href="/assets/js/7.8e4037c3.js"><link rel="prefetch" href="/assets/js/8.5752a787.js"><link rel="prefetch" href="/assets/js/9.8329deb8.js"><link rel="prefetch" href="/assets/js/10.4843c5ba.js"><link rel="prefetch" href="/assets/js/11.9e8b7549.js"><link rel="prefetch" href="/assets/js/12.02c0fa30.js"><link rel="prefetch" href="/assets/js/13.f5d738e8.js"><link rel="prefetch" href="/assets/js/14.24f8e576.js"><link rel="prefetch" href="/assets/js/15.e752518b.js"><link rel="prefetch" href="/assets/js/16.d74da356.js"><link rel="prefetch" href="/assets/js/17.5759e4d8.js"><link rel="prefetch" href="/assets/js/18.4e466a14.js"><link rel="prefetch" href="/assets/js/19.60a2d73f.js"><link rel="prefetch" href="/assets/js/20.c9a0e62d.js"><link rel="prefetch" href="/assets/js/21.40026d70.js"><link rel="prefetch" href="/assets/js/22.c5b0ef8a.js"><link rel="prefetch" href="/assets/js/23.6f254965.js"><link rel="prefetch" href="/assets/js/24.fcf66f98.js"><link rel="prefetch" href="/assets/js/25.76bed4da.js"><link rel="prefetch" href="/assets/js/26.a29ecb98.js"><link rel="prefetch" href="/assets/js/27.19c14279.js"><link rel="prefetch" href="/assets/js/28.da0a820a.js"><link rel="prefetch" href="/assets/js/29.ac0b92bb.js"><link rel="prefetch" href="/assets/js/30.2f36adb4.js"><link rel="prefetch" href="/assets/js/31.3b64636b.js"><link rel="prefetch" href="/assets/js/33.68e3f3f0.js"><link rel="prefetch" href="/assets/js/34.3996b8a2.js"><link rel="prefetch" href="/assets/js/35.6b7df171.js"><link rel="prefetch" href="/assets/js/36.01c663d5.js"><link rel="prefetch" href="/assets/js/37.24b862f7.js"><link rel="prefetch" href="/assets/js/38.27c698de.js"><link rel="prefetch" href="/assets/js/39.39eda98a.js"><link rel="prefetch" href="/assets/js/40.0d3a27e1.js"><link rel="prefetch" href="/assets/js/41.36133d84.js"><link rel="prefetch" href="/assets/js/42.4f708108.js"><link rel="prefetch" href="/assets/js/43.286ed069.js"><link rel="prefetch" href="/assets/js/44.69931ba8.js"><link rel="prefetch" href="/assets/js/45.9b6a53af.js"><link rel="prefetch" href="/assets/js/46.44e01f27.js"><link rel="prefetch" href="/assets/js/47.86ea0068.js"><link rel="prefetch" href="/assets/js/48.6d6e8398.js"><link rel="prefetch" href="/assets/js/49.eb3a0c16.js"><link rel="prefetch" href="/assets/js/50.5b9dbd38.js"><link rel="prefetch" href="/assets/js/51.e16cec94.js"><link rel="prefetch" href="/assets/js/52.08a38998.js"><link rel="prefetch" href="/assets/js/53.eab809f5.js"><link rel="prefetch" href="/assets/js/54.d13dbba6.js"><link rel="prefetch" href="/assets/js/55.6808ce92.js"><link rel="prefetch" href="/assets/js/56.096d270b.js"><link rel="prefetch" href="/assets/js/57.e4249cdf.js"><link rel="prefetch" href="/assets/js/58.c8669079.js"><link rel="prefetch" href="/assets/js/59.ad4f9d5d.js"><link rel="prefetch" href="/assets/js/60.1fb42366.js"><link rel="prefetch" href="/assets/js/61.cabe5660.js"><link rel="prefetch" href="/assets/js/62.fa1a1298.js"><link rel="prefetch" href="/assets/js/63.45ab79de.js"><link rel="prefetch" href="/assets/js/64.1b1f9f0e.js"><link rel="prefetch" href="/assets/js/65.8ec5686f.js"><link rel="prefetch" href="/assets/js/66.c678baef.js"><link rel="prefetch" href="/assets/js/67.19e5c964.js"><link rel="prefetch" href="/assets/js/68.1ed9f179.js"><link rel="prefetch" href="/assets/js/69.c24b07f2.js"><link rel="prefetch" href="/assets/js/70.0d51bff2.js"><link rel="prefetch" href="/assets/js/71.c4b4b293.js"><link rel="prefetch" href="/assets/js/72.14906a78.js"><link rel="prefetch" href="/assets/js/73.63ff0ad9.js"><link rel="prefetch" href="/assets/js/74.b9adca9b.js"><link rel="prefetch" href="/assets/js/75.545e5298.js"><link rel="prefetch" href="/assets/js/76.a0b47a49.js"><link rel="prefetch" href="/assets/js/77.7e27edab.js"><link rel="prefetch" href="/assets/js/78.1142e5fa.js"><link rel="prefetch" href="/assets/js/79.7c5cfce2.js"><link rel="prefetch" href="/assets/js/80.fc2c556d.js"><link rel="prefetch" href="/assets/js/81.8879b553.js"><link rel="prefetch" href="/assets/js/82.eacf1768.js"><link rel="prefetch" href="/assets/js/83.e45b0c21.js"><link rel="prefetch" href="/assets/js/84.1a4d1083.js"><link rel="prefetch" href="/assets/js/85.03758b26.js"><link rel="prefetch" href="/assets/js/86.ee483071.js"><link rel="prefetch" href="/assets/js/87.7b7f9f7e.js"><link rel="prefetch" href="/assets/js/88.ac9c1638.js"><link rel="prefetch" href="/assets/js/89.eb052447.js"><link rel="prefetch" href="/assets/js/90.422140a0.js"><link rel="prefetch" href="/assets/js/91.1590a6f8.js"><link rel="prefetch" href="/assets/js/92.96889e30.js"><link rel="prefetch" href="/assets/js/93.781dc372.js"><link rel="prefetch" href="/assets/js/94.67dfc4fd.js"><link rel="prefetch" href="/assets/js/95.2ec84126.js"><link rel="prefetch" href="/assets/js/96.9c8d4164.js"><link rel="prefetch" href="/assets/js/97.8e9b31ed.js"><link rel="prefetch" href="/assets/js/98.9842e1fc.js"><link rel="prefetch" href="/assets/js/99.393bed11.js"><link rel="prefetch" href="/assets/js/100.cce59a63.js"><link rel="prefetch" href="/assets/js/101.a716746b.js"><link rel="prefetch" href="/assets/js/102.8c93513c.js"><link rel="prefetch" href="/assets/js/103.d3a45484.js"><link rel="prefetch" href="/assets/js/104.ce471cd5.js"><link rel="prefetch" href="/assets/js/105.333da2a2.js"><link rel="prefetch" href="/assets/css/106.styles.2ca1612a.css"><link rel="prefetch" href="/assets/js/106.2ca1612a.js"><link rel="prefetch" href="/assets/css/107.styles.da40c964.css"><link rel="prefetch" href="/assets/js/107.da40c964.js">
    <link rel="stylesheet" href="/assets/css/106.styles.2ca1612a.css"><link rel="stylesheet" href="/assets/css/107.styles.da40c964.css"><link rel="stylesheet" href="/assets/css/styles.ded2f491.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">油腻中年大叔</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dart/" class="nav-link">Dart</a></div><div class="nav-item"><a href="/spring/" class="nav-link">spring</a></div><div class="nav-item"><a href="/drools/" class="nav-link">规则和业务流程</a></div><div class="nav-item"><a href="/eip/" class="nav-link">EIP集成工具</a></div><div class="nav-item"><a href="/other/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/algorithms/" class="nav-link">算法</a></div><div class="nav-item"><a href="/riding/" class="nav-link">骑行</a></div><div class="nav-item"><a href="/ev3/" class="nav-link">LEGO EV3 </a></div><div class="nav-item"><a href="/mb/" class="nav-link">Micro:bit </a></div><div class="nav-item"><a href="/math/" class="nav-link">小学数学 </a></div><div class="nav-item"><a href="/eng/" class="nav-link">小学英语 </a></div><div class="nav-item"><a href="/jp/" class="nav-link">日语 </a></div><div class="nav-item"><a href="/gs1/" class="nav-link">GS-1</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dart/" class="nav-link">Dart</a></div><div class="nav-item"><a href="/spring/" class="nav-link">spring</a></div><div class="nav-item"><a href="/drools/" class="nav-link">规则和业务流程</a></div><div class="nav-item"><a href="/eip/" class="nav-link">EIP集成工具</a></div><div class="nav-item"><a href="/other/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/algorithms/" class="nav-link">算法</a></div><div class="nav-item"><a href="/riding/" class="nav-link">骑行</a></div><div class="nav-item"><a href="/ev3/" class="nav-link">LEGO EV3 </a></div><div class="nav-item"><a href="/mb/" class="nav-link">Micro:bit </a></div><div class="nav-item"><a href="/math/" class="nav-link">小学数学 </a></div><div class="nav-item"><a href="/eng/" class="nav-link">小学英语 </a></div><div class="nav-item"><a href="/jp/" class="nav-link">日语 </a></div><div class="nav-item"><a href="/gs1/" class="nav-link">GS-1</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/other/aws-deploy.html" class="sidebar-link">AWS VPC网络部署参考</a></li><li><a href="/other/iot.html" class="active sidebar-link">aws IoT</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/iot.html#平台架构" class="sidebar-link">平台架构</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#aws服务" class="sidebar-link">AWS服务</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#sdk" class="sidebar-link">SDK</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#认证和授权" class="sidebar-link">认证和授权</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#注册表" class="sidebar-link">注册表</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#shadow" class="sidebar-link">Shadow</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/iot.html#shadow服务用途" class="sidebar-link">Shadow服务用途</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#影子服务" class="sidebar-link">影子服务</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#控制模型" class="sidebar-link">控制模型</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#工作原理" class="sidebar-link">工作原理</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#格式" class="sidebar-link">格式</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#关键属性" class="sidebar-link">关键属性</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#影子文档语法" class="sidebar-link">影子文档语法</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#预留主题" class="sidebar-link">预留主题</a></li></ul></li><li class="sidebar-sub-header"><a href="/other/iot.html#sample-程序" class="sidebar-link">Sample 程序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/iot.html#basicpubsub-py" class="sidebar-link">basicPubSub.py</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#basicpubsubasync-py" class="sidebar-link">basicPubSubAsync.py</a></li><li class="sidebar-sub-header"><a href="/other/iot.html#异常" class="sidebar-link">异常</a></li></ul></li></ul></li><li><a href="/other/aws.html" class="sidebar-link">aws 常用操作</a></li><li><a href="/other/singletonAndMultiton.html" class="sidebar-link">Design Pattern Series: Singleton and Multiton Pattern</a></li><li><a href="/other/magick.html" class="sidebar-link">Image Magick参考</a></li><li><a href="/other/oss.html" class="sidebar-link">阿里OSS使用技巧</a></li><li><a href="/other/awk.html" class="sidebar-link">awk cheat sheet</a></li><li><a href="/other/redissearch.html" class="sidebar-link">Redis search with Lua</a></li><li><a href="/other/shell.html" class="sidebar-link">我的shell环境</a></li><li><a href="/other/mongo.html" class="sidebar-link">Mongo 常用操作</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="aws-iot"><a href="#aws-iot" aria-hidden="true" class="header-anchor">#</a> AWS IoT</h1> <h2 id="平台架构"><a href="#平台架构" aria-hidden="true" class="header-anchor">#</a> 平台架构</h2> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/e46d02610b899f7fbcb94fdad791f2b2/image.png" alt="image"></p> <h2 id="aws服务"><a href="#aws服务" aria-hidden="true" class="header-anchor">#</a> AWS服务</h2> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/3c78702c065f7b113a1f7be6ade53cc1/image.png" alt="image"></p> <ul><li>Amazon DynamoDB—托管NoSQL数据库</li> <li>Amazon Kinesis—大规模流式数据实时处理</li> <li>AWS Lambda—EC2云虚拟机运行代码响应事件</li> <li>Amazon Simple Storage Service（S3）—可扩展云存储</li> <li>Amazon Simple Notification—推送通知服务</li> <li>Amazon Simple Queue Service—消息队列服务</li></ul> <h2 id="sdk"><a href="#sdk" aria-hidden="true" class="header-anchor">#</a> SDK</h2> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/7d868a5192913c289a3ea608787c82d7/image.png" alt="image"></p> <ul><li>AWS IoT 设备 SDK 使用 MQTT、HTTP 或 WebSockets 协议将硬件设备连接到 AWS IoT，硬件设备无缝安全地与 AWS IoT 提供的设备网关和设备影子协作。</li> <li>设备 SDK 支持 C、JavaScript 、Arduino、Java和Python。</li> <li>设备 SDK 包含开源库、带有示例的开发人员指南和移植指南，用户根据硬件平台构建 IoT 产品或解决方案。</li></ul> <p>设备网关</p> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/12a0c3a63e85a60a2644e42f53b59f61/image.png" alt="image"></p> <ul><li>AWS IoT 设备网关支持设备安全高效地与 AWS IoT 进行通信。设备网关可以使用发布/订阅模式交换消息，从而支持一对一和一对多的通信。凭借此一对多的通信模式，AWS IoT 将支持互连设备向多名给定主题的订阅者广播数据。</li> <li>设备网关支持 MQTT、WebSocket 和 HTTP 1.1 协议，也支持私有协议。</li> <li>设备网关可自动扩展，以支持 10 亿多台设备，而无需预配置基础设施。</li></ul> <h2 id="认证和授权"><a href="#认证和授权" aria-hidden="true" class="header-anchor">#</a> 认证和授权</h2> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/46f0e7944563e1a9b91275933f7fd067/image.png" alt="image"></p> <ul><li>AWS IoT 在所有连接点处提供相互身份验证和加密。AWS IoT 支持 AWS 身份验证方法（称为&quot;SigV4&quot;）以及基于身份验证的 X.509 证书。使用 HTTP 的连接可以使用任一方法，使用 MQTT 的连接可以使用基于证书的身份验证，使用 WebSockets 的连接可以使用 SigV4。</li> <li>使用 AWS IoT 生成的证书以及由首选证书颁发机构 (CA) 签署的证书，将所选的角色和/或策略映射到每个证书，以便授予设备或应用程序访问权限，或撤消访问权限。</li> <li>通过控制台或使用 API 创建、部署并管理设备的证书和策略。这些设备证书可以预配置、激活和与使用 AWS IAM 配置的相关策略关联。</li> <li>AWS IoT 还支持用户移动应用使用 Amazon Cognito 进行连接，Amazon Cognito 将负责执行必要的操作来为应用用户创建唯一标识符并获取临时的、权限受限的 AWS 凭证</li></ul> <h2 id="注册表"><a href="#注册表" aria-hidden="true" class="header-anchor">#</a> 注册表</h2> <ul><li>注册表将创建设备标识并跟踪元数据，如设备的属性和功能。</li> <li>注册表向格式一致的每台设备分配唯一的标识，而不管设备的类型和连接方式为何。此外，它还支持描述设备功能的元数据，例如传感器是否报告温度，以及数据是华氏度还是摄氏度。</li> <li>注册表存储有关设备的元数据，无需支付额外费用；并且需要每隔 7 天至少访问或更新注册表条目一次，注册表中的元数据就不会过期。</li></ul> <p>以JSON格式存储的设备注册表信息
<img src="http://git.manystar.com/marszhang/notebook-mars/uploads/75a353f4bb6247473ede44eedf1296ae/image.png" alt="image"></p> <h2 id="shadow"><a href="#shadow" aria-hidden="true" class="header-anchor">#</a> Shadow</h2> <h3 id="shadow服务用途"><a href="#shadow服务用途" aria-hidden="true" class="header-anchor">#</a> Shadow服务用途</h3> <p>设备的影子 是用于存储和检索设备的当前状态信息的 JSON 文档。Device Shadow 服务可以为您连接到 AWS IoT 的每台设备保留一个影子。您可以使用该影子通过 MQTT 或 HTTP 获取和设置设备的状态，无论该设备是否连接到 Internet。每台设备的影子都由相应事物的名称唯一标识。
<img src="http://git.manystar.com/marszhang/notebook-mars/uploads/279677d104aebb87e5c294fd012822ff/image.png" alt="image"></p> <ul><li>设备影子保留每台设备的最后报告状态和期望的未来状态，即便设备处于离线状态。</li> <li>通过 API 或使用规则引擎，获取设备的最后报告状态或设置期望的未来状态。</li> <li>应用程序可以设置设备的期望未来状态，而无需说明设备的当前状态。AWS IoT 将比较期望未来状态和最后报告状态之间的差异，并命令设备&quot;弥补差异&quot;。</li> <li>设备 SDK 能够轻松地同步其状态及其影子，并响应通过影子设置的期望的未来状态。</li> <li>设备影子免费存储设备状态多达一年。如果至少每年更新一次状态，则设备影子将永久保留状态；否则状态将过期。</li></ul> <h3 id="影子服务"><a href="#影子服务" aria-hidden="true" class="header-anchor">#</a> 影子服务</h3> <p>设备影子服务使用MQTT话题，便于应用和设备之间的通信，下面是相关的MQTT QoS 1话题：</p> <p>$aws/things/{thingName}/shadow/update</p> <p>$aws/things/{thingName}/shadow/get</p> <p>$aws/things/{thingName}/shadow/delete</p> <p>$aws/things/{thingName}/shadow/update/accepted</p> <p>$aws/things/{thingName}/shadow/update/rejected</p> <p>$aws/things/{thingName}/shadow/update/delta</p> <p>$aws/things/{thingName}/shadow/get/accepted</p> <p>$aws/things/{thingName}/shadow/get/rejected</p> <p>$aws/things/{thingName}/shadow/delete/accepted</p> <p>$aws/things/{thingName}/shadow/delete/rejected</p> <p>设备SDK（C-SDK、JS-SDK）将影子功能内置在设备中，能够使设备与影子服务之间自动同步状态。</p> <h3 id="控制模型"><a href="#控制模型" aria-hidden="true" class="header-anchor">#</a> 控制模型</h3> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/1b53521c576beb953300cb573babb736/image.png" alt="image">
控制灯泡
<img src="http://git.manystar.com/marszhang/notebook-mars/uploads/9a921de9c2d510a251b789aaf60d5416/image.png" alt="image"></p> <h3 id="工作原理"><a href="#工作原理" aria-hidden="true" class="header-anchor">#</a> 工作原理</h3> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/fa8daac0611b0f4ffe080aed7062ecf8/image.png" alt="image"></p> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/37da2277a08fcca859c153b6834efe42/image.png" alt="image"></p> <p>1.连接着的 Led 灯发送封装在MQTT消息中的 reported 状态 『off』 到 AWS IoT
2.AWS IoT 通过 led 灯使用的证书来确定它所属的虚拟事物
3.AWS IoT 将 reported 状态保存在设备影子 JSON 文件中
4.一条 AWS IoT rule 正监控着 led 的 off 状态，它发送一个消息到某个 SNS topic
5.某 application 收到 SNS 消息。用户将 led 期望状态（desired state）设置为 on
6. AWS IoT 收到该消息，它更新设备影子中的 desired state，同时发送包含期望状态的 message 到某些topic。此时，reported 和 desired 状态是 『Out of Sync』的
7. led 收到 delta 消息，开始根据其中的 desired status 来设置其实际状态
8. led 将其状态设置为 on，向 MQTT topic 发送新的 reported 状态
9. AWS IoT 更新设备影子，现在该设备的 reported 和 desired 状态一致了</p> <h3 id="格式"><a href="#格式" aria-hidden="true" class="header-anchor">#</a> 格式</h3> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/ba398a3c48b6b7d77d8a2f048735550a/image.png" alt="image"></p> <h3 id="关键属性"><a href="#关键属性" aria-hidden="true" class="header-anchor">#</a> 关键属性</h3> <p><img src="http://git.manystar.com/marszhang/notebook-mars/uploads/e2b49474ae7db2783464ea52d205acfd/image.png" alt="image"></p> <h4 id="影子文档属性"><a href="#影子文档属性" aria-hidden="true" class="header-anchor">#</a> 影子文档属性</h4> <p>设备的影子文档具有以下属性：</p> <ul><li>state</li></ul> <ul><li><p>desired 事物的预期状态。应用程序可以向本文档部分写入数据来更新事物的状态，且无需直接连接到该事物。</p></li> <li><p>reported 事物的报告状态。事物可以向本文档部分写入数据，以报告其新状态。应用程序可以读取本文档部分，以确定事物的状态。</p></li> <li><p>metadata 有关存储在文档 state 部分的数据的信息，其中包括 state 部分中每个属性的时间戳（以 Epoch 时间表示），让您能够确定它们的更新时间。</p></li> <li><p>timestamp 指明 AWS IoT 传输消息的时间。通过在消息中使用时间戳并对 desired 或 reported 部分中的不同属性使用时间戳，事物可以确定已更新项目的存在时间，即使它不具有内部时钟特性。</p></li> <li><p>clientToken 特定于设备的字符串，让您能在 MQTT 环境中将响应与请求关联起来。</p></li> <li><p>version 文档版本。文档每次更新时，此版本号都会递增。用于确保正在更新的文档为最新版本。</p></li></ul> <h3 id="影子文档语法"><a href="#影子文档语法" aria-hidden="true" class="header-anchor">#</a> 影子文档语法</h3> <h4 id="请求结构"><a href="#请求结构" aria-hidden="true" class="header-anchor">#</a> 请求结构</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;desired&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer2<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string2&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean2
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reported&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer1<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string1&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean1
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token property">&quot;clientToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> version
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="响应状态"><a href="#响应状态" aria-hidden="true" class="header-anchor">#</a> 响应状态</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;desired&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer2<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string2&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean2
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reported&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer1<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string1&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean1
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;delta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute3&quot;</span><span class="token operator">:</span> integerX<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute5&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stringY&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;desired&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reported&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp<span class="token punctuation">,</span>
    <span class="token property">&quot;clientToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> version
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h4 id="错误响应"><a href="#错误响应" aria-hidden="true" class="header-anchor">#</a> 错误响应</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> error-code<span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error-message&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp<span class="token punctuation">,</span>
    <span class="token property">&quot;clientToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;token&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="预留主题"><a href="#预留主题" aria-hidden="true" class="header-anchor">#</a> 预留主题</h3> <p>aws Iot预留了一些主题，预留的主题以$开头。除非下面列出的主题之外，不支持用于进行发布和订阅。在任何其他以 $ 开头的主题中尝试发布或订阅将导致连接被终止。</p> <table><thead><tr><th>主题</th> <th>允许的操作</th> <th>描述</th></tr></thead> <tbody><tr><td>$aws/events/presence/connected/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端连接至 AWS IoT 时，AWS IoT 将向此主题发布。有关更多信息，请参阅 连接/断开连接事件。</td></tr> <tr><td>$aws/events/presence/disconnected/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端与 AWS IoT 断开连接时，AWS IoT 将向此主题发布。有关更多信息，请参阅 连接/断开连接事件。</td></tr> <tr><td>$aws/events/subscriptions/subscribed/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端订阅 MQTT 主题时，AWS IoT 将向此主题发布。有关更多信息，请参阅 订阅/取消订阅事件。</td></tr> <tr><td>$aws/events/subscriptions/unsubscribed/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端取消订阅 MQTT 主题时，AWS IoT 将向此主题发布。有关更多信息，请参阅 订阅/取消订阅事件。</td></tr> <tr><td>$aws/things/thingName/shadow/delete</td> <td>发布/订阅</td> <td>设备或应用程序向此主题发布消息以删除影子。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#delete-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/delete/accepted</td> <td>Subscribe</td> <td>当一个影子被删除时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#delete-accepted-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/delete/rejected</td> <td>Subscribe</td> <td>当删除影子的请求遭拒时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#delete-rejected-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/get</td> <td>发布/订阅</td> <td>应用程序或事物向此主题发布空消息来获取影子。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html。</td></tr> <tr><td>$aws/things/thingName/shadow/get/accepted</td> <td>Subscribe</td> <td>当获取影子的请求获批时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#get-accepted-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/get/rejected</td> <td>Subscribe</td> <td>当获取影子的请求遭拒时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#get-rejected-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update</td> <td>发布/订阅</td> <td>事物或应用程序向此主题发布消息以更新影子。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/accepted</td> <td>Subscribe</td> <td>当影子更新成功时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-accepted-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/rejected</td> <td>Subscribe</td> <td>当影子更新遭拒时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-rejected-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/delta</td> <td>Subscribe</td> <td>当检测到影子的“reported”部分与“desired”部分之间存在差异时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-delta-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/documents</td> <td>Subscribe</td> <td>每次影子更新成功执行时，AWS IoT 都会向该主题发布状态文档。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-documents-pub-sub-topic。</td></tr></tbody></table> <h2 id="sample-程序"><a href="#sample-程序" aria-hidden="true" class="header-anchor">#</a> Sample 程序</h2> <h3 id="basicpubsub-py"><a href="#basicpubsub-py" aria-hidden="true" class="header-anchor">#</a> basicPubSub.py</h3> <p>这个程序可以作publish也可以作subscribe，或者同时运行。</p> <p>当publish时
每隔1s产生一个消息</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>loopCount <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'both'</span> <span class="token operator">or</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'publish'</span><span class="token punctuation">:</span>
        message <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        message<span class="token punctuation">[</span><span class="token string">'message'</span><span class="token punctuation">]</span> <span class="token operator">=</span> args<span class="token punctuation">.</span>message
        message<span class="token punctuation">[</span><span class="token string">'sequence'</span><span class="token punctuation">]</span> <span class="token operator">=</span> loopCount
        messageJson <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>message<span class="token punctuation">)</span>
        myAWSIoTMQTTClient<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>topic<span class="token punctuation">,</span> messageJson<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'publish'</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Published topic %s: %s\n'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>topic<span class="token punctuation">,</span> messageJson<span class="token punctuation">)</span><span class="token punctuation">)</span>
        loopCount <span class="token operator">+=</span> <span class="token number">1</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>当作subscribe时，由于注册了calback函数，在收到消息时候会有一个调用</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">customCallback</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> userdata<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Received a new message: &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>payload<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;from topic: &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>topic<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;--------------\n\n&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># Connect and subscribe to AWS IoT</span>
myAWSIoTMQTTClient<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'both'</span> <span class="token operator">or</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'subscribe'</span><span class="token punctuation">:</span>
    myAWSIoTMQTTClient<span class="token punctuation">.</span>subscribe<span class="token punctuation">(</span>topic<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> customCallback<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>输出如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>2018-08-16 17:23:51,459 - AWSIoTPythonSDK.core.protocol.internal.clients - DEBUG - Invoking custom event callback<span class="token punctuation">..</span>.
2018-08-16 17:23:56,435 - AWSIoTPythonSDK.core.protocol.internal.workers - DEBUG - Produced <span class="token punctuation">[</span>message<span class="token punctuation">]</span> event
2018-08-16 17:23:56,435 - AWSIoTPythonSDK.core.protocol.internal.workers - DEBUG - Dispatching <span class="token punctuation">[</span>message<span class="token punctuation">]</span> event
Received a new message: 
b<span class="token string">'{&quot;message&quot;: &quot;Hello World!&quot;, &quot;sequence&quot;: 18}'</span>
from topic: 
sdk/test/Python
--------------

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="basicpubsubasync-py"><a href="#basicpubsubasync-py" aria-hidden="true" class="header-anchor">#</a> basicPubSubAsync.py</h3> <p>注意ackCallback与messageCallback区别</p> <p><em>ackCallback</em> - Callback to be invoked when the client receives a SUBACK. Should be in form
<em>messageCallback</em> - Function to be called when a new message for the subscribed topic comes in.</p> <p>SUBACK： 服务端发送SUBACK报文给客户端，用于确认它已收到并且正在处理SUBSCRIBE报文。简单理解为服务器端通知订阅客户端&quot;我知道你要订阅了&quot;</p> <p>详细参考：https://mcxiaoke.gitbooks.io/mqtt-cn/content/mqtt/0309-SUBACK.html</p> <h3 id="异常"><a href="#异常" aria-hidden="true" class="header-anchor">#</a> 异常</h3> <p>sample程序可能会遇到exception，这多数是授权策略引起的。开发调试状态下</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;Version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2012-10-17&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Statement&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;iot:*&quot;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;*&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/other/aws-deploy.html" class="prev">
          AWS VPC网络部署参考
        </a></span> <span class="next"><a href="/other/aws.html">
          aws 常用操作
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/32.ab10440c.js" defer></script><script src="/assets/js/app.ded2f491.js" defer></script>
  </body>
</html>
