<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Shadow | 油腻中年大叔</title>
    <meta name="description" content="你想要的这里都没有，你不想要的这里都有">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    
    <link rel="preload" href="/assets/css/styles.7863e8ac.css" as="style"><link rel="preload" href="/assets/js/app.7863e8ac.js" as="script"><link rel="preload" href="/assets/js/35.6a4f99be.js" as="script"><link rel="prefetch" href="/assets/js/0.eb7108e7.js"><link rel="prefetch" href="/assets/js/1.d8ec4d72.js"><link rel="prefetch" href="/assets/js/2.28f90b8d.js"><link rel="prefetch" href="/assets/js/3.6001361f.js"><link rel="prefetch" href="/assets/js/4.80c27a58.js"><link rel="prefetch" href="/assets/js/5.2e2f809b.js"><link rel="prefetch" href="/assets/js/6.0d0d8441.js"><link rel="prefetch" href="/assets/js/7.8e4037c3.js"><link rel="prefetch" href="/assets/js/8.5752a787.js"><link rel="prefetch" href="/assets/js/9.8329deb8.js"><link rel="prefetch" href="/assets/js/10.4843c5ba.js"><link rel="prefetch" href="/assets/js/11.9e8b7549.js"><link rel="prefetch" href="/assets/js/12.02c0fa30.js"><link rel="prefetch" href="/assets/js/13.f5d738e8.js"><link rel="prefetch" href="/assets/js/14.ca4b3249.js"><link rel="prefetch" href="/assets/js/15.cf61b2ec.js"><link rel="prefetch" href="/assets/js/16.2b67aa0e.js"><link rel="prefetch" href="/assets/js/17.b99a459f.js"><link rel="prefetch" href="/assets/js/18.2d5afa9a.js"><link rel="prefetch" href="/assets/js/19.6c36dff4.js"><link rel="prefetch" href="/assets/js/20.3e0dc870.js"><link rel="prefetch" href="/assets/js/21.227ee5ec.js"><link rel="prefetch" href="/assets/js/22.05c1f0f0.js"><link rel="prefetch" href="/assets/js/23.c6dbeed0.js"><link rel="prefetch" href="/assets/js/24.957b4252.js"><link rel="prefetch" href="/assets/js/25.b50e4879.js"><link rel="prefetch" href="/assets/js/26.1b2b16cf.js"><link rel="prefetch" href="/assets/js/27.2f0f5e4c.js"><link rel="prefetch" href="/assets/js/28.ffafaa79.js"><link rel="prefetch" href="/assets/js/29.38ab4732.js"><link rel="prefetch" href="/assets/js/30.7258c2eb.js"><link rel="prefetch" href="/assets/js/31.6cc6f25e.js"><link rel="prefetch" href="/assets/js/32.cae8f5c2.js"><link rel="prefetch" href="/assets/js/33.7bac5900.js"><link rel="prefetch" href="/assets/js/34.e457a7ab.js"><link rel="prefetch" href="/assets/js/36.3fa7b425.js"><link rel="prefetch" href="/assets/js/37.9627a576.js"><link rel="prefetch" href="/assets/js/38.8f902270.js"><link rel="prefetch" href="/assets/js/39.2fb6b1fd.js"><link rel="prefetch" href="/assets/js/40.0f992849.js"><link rel="prefetch" href="/assets/js/41.1921a30c.js"><link rel="prefetch" href="/assets/js/42.196053b0.js"><link rel="prefetch" href="/assets/js/43.6a2cc6b2.js"><link rel="prefetch" href="/assets/js/44.c3b31b69.js"><link rel="prefetch" href="/assets/js/45.dd90e897.js"><link rel="prefetch" href="/assets/js/46.547a7ce9.js"><link rel="prefetch" href="/assets/js/47.a62be284.js"><link rel="prefetch" href="/assets/js/48.edc6618c.js"><link rel="prefetch" href="/assets/js/49.b3d5118e.js"><link rel="prefetch" href="/assets/js/50.81540475.js"><link rel="prefetch" href="/assets/js/51.c2c1171b.js"><link rel="prefetch" href="/assets/js/52.ba318094.js"><link rel="prefetch" href="/assets/js/53.a2d5d15e.js"><link rel="prefetch" href="/assets/js/54.3608cfdf.js"><link rel="prefetch" href="/assets/js/55.73c0d459.js"><link rel="prefetch" href="/assets/js/56.9706fe8c.js"><link rel="prefetch" href="/assets/js/57.f5a08e9a.js"><link rel="prefetch" href="/assets/js/58.ea9c9ad0.js"><link rel="prefetch" href="/assets/js/59.9d363669.js"><link rel="prefetch" href="/assets/js/60.8a80b28f.js"><link rel="prefetch" href="/assets/js/61.73e5c6a8.js"><link rel="prefetch" href="/assets/js/62.30aab875.js"><link rel="prefetch" href="/assets/js/63.1e86c5c0.js"><link rel="prefetch" href="/assets/js/64.9c071a1e.js"><link rel="prefetch" href="/assets/js/65.61d8d11c.js"><link rel="prefetch" href="/assets/js/66.dd39544e.js"><link rel="prefetch" href="/assets/js/67.6dd79cd2.js"><link rel="prefetch" href="/assets/js/68.dd07b2a3.js"><link rel="prefetch" href="/assets/js/69.a5a81dbc.js"><link rel="prefetch" href="/assets/js/70.3f26faed.js"><link rel="prefetch" href="/assets/js/71.1234830b.js"><link rel="prefetch" href="/assets/js/72.d4db7f16.js"><link rel="prefetch" href="/assets/js/73.e2b0a283.js"><link rel="prefetch" href="/assets/js/74.db6d3ebc.js"><link rel="prefetch" href="/assets/js/75.4516323c.js"><link rel="prefetch" href="/assets/js/76.a086fd94.js"><link rel="prefetch" href="/assets/js/77.165f6d28.js"><link rel="prefetch" href="/assets/js/78.81cd058e.js"><link rel="prefetch" href="/assets/js/79.fde8c00b.js"><link rel="prefetch" href="/assets/js/80.142b728c.js"><link rel="prefetch" href="/assets/js/81.367c9c5e.js"><link rel="prefetch" href="/assets/js/82.d23176e0.js"><link rel="prefetch" href="/assets/js/83.d9571f6f.js"><link rel="prefetch" href="/assets/js/84.6214056c.js"><link rel="prefetch" href="/assets/js/85.66cc6092.js"><link rel="prefetch" href="/assets/js/86.18dba812.js"><link rel="prefetch" href="/assets/js/87.9506d9f8.js"><link rel="prefetch" href="/assets/js/88.b42d6720.js"><link rel="prefetch" href="/assets/js/89.5c0033c4.js"><link rel="prefetch" href="/assets/js/90.069a50d4.js"><link rel="prefetch" href="/assets/js/91.61fe3c31.js"><link rel="prefetch" href="/assets/js/92.e4211585.js"><link rel="prefetch" href="/assets/js/93.6df74471.js"><link rel="prefetch" href="/assets/js/94.d61ebe6e.js"><link rel="prefetch" href="/assets/js/95.c60c8a69.js"><link rel="prefetch" href="/assets/js/96.e3124488.js"><link rel="prefetch" href="/assets/js/97.bce37e32.js"><link rel="prefetch" href="/assets/js/98.a1fb95ac.js"><link rel="prefetch" href="/assets/js/99.f9c12b84.js"><link rel="prefetch" href="/assets/js/100.0b3aaca9.js"><link rel="prefetch" href="/assets/js/101.03f32ae7.js"><link rel="prefetch" href="/assets/js/102.69cca032.js"><link rel="prefetch" href="/assets/js/103.190dc3ef.js"><link rel="prefetch" href="/assets/js/104.6e7ceda7.js"><link rel="prefetch" href="/assets/js/105.f852f5a7.js"><link rel="prefetch" href="/assets/js/106.9335f238.js"><link rel="prefetch" href="/assets/js/107.1404f516.js"><link rel="prefetch" href="/assets/js/108.dd6bb5e3.js"><link rel="prefetch" href="/assets/js/109.a87f5640.js"><link rel="prefetch" href="/assets/js/110.fb0da049.js"><link rel="prefetch" href="/assets/js/111.cc64ddd7.js"><link rel="prefetch" href="/assets/css/112.styles.75c39ee5.css"><link rel="prefetch" href="/assets/js/112.75c39ee5.js"><link rel="prefetch" href="/assets/css/113.styles.407e8d7f.css"><link rel="prefetch" href="/assets/js/113.407e8d7f.js">
    <link rel="stylesheet" href="/assets/css/112.styles.75c39ee5.css"><link rel="stylesheet" href="/assets/css/113.styles.407e8d7f.css"><link rel="stylesheet" href="/assets/css/styles.7863e8ac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">油腻中年大叔</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dart/" class="nav-link">Dart</a></div><div class="nav-item"><a href="/spring/" class="nav-link">spring</a></div><div class="nav-item"><a href="/drools/" class="nav-link">规则和业务流程</a></div><div class="nav-item"><a href="/eip/" class="nav-link">EIP集成工具</a></div><div class="nav-item"><a href="/other/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/algorithms/" class="nav-link">算法</a></div><div class="nav-item"><a href="/riding/" class="nav-link">骑行</a></div><div class="nav-item"><a href="/ev3/" class="nav-link">LEGO EV3 </a></div><div class="nav-item"><a href="/rubik/" class="nav-link">魔方</a></div><div class="nav-item"><a href="/mb/" class="nav-link">Micro:bit </a></div><div class="nav-item"><a href="/math/" class="nav-link">小学数学 </a></div><div class="nav-item"><a href="/eng/" class="nav-link">小学英语 </a></div><div class="nav-item"><a href="/jp/" class="nav-link">日语 </a></div><div class="nav-item"><a href="/gs1/" class="nav-link">GS-1</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dart/" class="nav-link">Dart</a></div><div class="nav-item"><a href="/spring/" class="nav-link">spring</a></div><div class="nav-item"><a href="/drools/" class="nav-link">规则和业务流程</a></div><div class="nav-item"><a href="/eip/" class="nav-link">EIP集成工具</a></div><div class="nav-item"><a href="/other/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/algorithms/" class="nav-link">算法</a></div><div class="nav-item"><a href="/riding/" class="nav-link">骑行</a></div><div class="nav-item"><a href="/ev3/" class="nav-link">LEGO EV3 </a></div><div class="nav-item"><a href="/rubik/" class="nav-link">魔方</a></div><div class="nav-item"><a href="/mb/" class="nav-link">Micro:bit </a></div><div class="nav-item"><a href="/math/" class="nav-link">小学数学 </a></div><div class="nav-item"><a href="/eng/" class="nav-link">小学英语 </a></div><div class="nav-item"><a href="/jp/" class="nav-link">日语 </a></div><div class="nav-item"><a href="/gs1/" class="nav-link">GS-1</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/other/aws-deploy.html" class="sidebar-link">AWS VPC网络部署参考</a></li><li><a href="/other/iot.html" class="sidebar-link">aws IoT</a></li><li><a href="/other/aws.html" class="sidebar-link">aws 常用操作</a></li><li><a href="/other/singletonAndMultiton.html" class="sidebar-link">Design Pattern Series: Singleton and Multiton Pattern</a></li><li><a href="/other/magick.html" class="sidebar-link">Image Magick参考</a></li><li><a href="/other/oss.html" class="sidebar-link">阿里OSS使用技巧</a></li><li><a href="/other/awk.html" class="sidebar-link">awk cheat sheet</a></li><li><a href="/other/redissearch.html" class="sidebar-link">Redis search with Lua</a></li><li><a href="/other/shell.html" class="sidebar-link">我的shell环境</a></li><li><a href="/other/mongo.html" class="sidebar-link">Mongo 常用操作</a></li></ul> </div> <div class="page"> <div class="content"><h2 id="shadow"><a href="#shadow" aria-hidden="true" class="header-anchor">#</a> Shadow</h2> <h2 id="shadow服务用途"><a href="#shadow服务用途" aria-hidden="true" class="header-anchor">#</a> Shadow服务用途</h2> <p>设备的影子 是用于存储和检索设备的当前状态信息的 JSON 文档。Device Shadow 服务可以为您连接到 AWS IoT 的每台设备保留一个影子。您可以使用该影子通过 MQTT 或 HTTP 获取和设置设备的状态，无论该设备是否连接到 Internet。每台设备的影子都由相应事物的名称唯一标识。
<img src="/uploads/279677d104aebb87e5c294fd012822ff/image.png" alt="image"></p> <ul><li>设备影子保留每台设备的最后报告状态和期望的未来状态，即便设备处于离线状态。</li> <li>通过 API 或使用规则引擎，获取设备的最后报告状态或设置期望的未来状态。</li> <li>应用程序可以设置设备的期望未来状态，而无需说明设备的当前状态。AWS IoT 将比较期望未来状态和最后报告状态之间的差异，并命令设备&quot;弥补差异&quot;。</li> <li>设备 SDK 能够轻松地同步其状态及其影子，并响应通过影子设置的期望的未来状态。</li> <li>设备影子免费存储设备状态多达一年。如果至少每年更新一次状态，则设备影子将永久保留状态；否则状态将过期。</li></ul> <h2 id="影子服务"><a href="#影子服务" aria-hidden="true" class="header-anchor">#</a> 影子服务</h2> <p>设备影子服务使用MQTT话题，便于应用和设备之间的通信，下面是相关的MQTT QoS 1话题：</p> <p>$aws/things/{thingName}/shadow/update</p> <p>$aws/things/{thingName}/shadow/get</p> <p>$aws/things/{thingName}/shadow/delete</p> <p>$aws/things/{thingName}/shadow/update/accepted</p> <p>$aws/things/{thingName}/shadow/update/rejected</p> <p>$aws/things/{thingName}/shadow/update/delta</p> <p>$aws/things/{thingName}/shadow/get/accepted</p> <p>$aws/things/{thingName}/shadow/get/rejected</p> <p>$aws/things/{thingName}/shadow/delete/accepted</p> <p>$aws/things/{thingName}/shadow/delete/rejected</p> <p>设备SDK（C-SDK、JS-SDK）将影子功能内置在设备中，能够使设备与影子服务之间自动同步状态。</p> <h2 id="控制模型"><a href="#控制模型" aria-hidden="true" class="header-anchor">#</a> 控制模型</h2> <p><img src="/uploads/1b53521c576beb953300cb573babb736/image.png" alt="image">
控制灯泡
<img src="/uploads/9a921de9c2d510a251b789aaf60d5416/image.png" alt="image"></p> <h2 id="工作原理"><a href="#工作原理" aria-hidden="true" class="header-anchor">#</a> 工作原理</h2> <p><img src="/uploads/fa8daac0611b0f4ffe080aed7062ecf8/image.png" alt="image"></p> <p><img src="/uploads/37da2277a08fcca859c153b6834efe42/image.png" alt="image"></p> <p>1.连接着的 Led 灯发送封装在MQTT消息中的 reported 状态 『off』 到 AWS IoT
2.AWS IoT 通过 led 灯使用的证书来确定它所属的虚拟事物
3.AWS IoT 将 reported 状态保存在设备影子 JSON 文件中
4.一条 AWS IoT rule 正监控着 led 的 off 状态，它发送一个消息到某个 SNS topic
5.某 application 收到 SNS 消息。用户将 led 期望状态（desired state）设置为 on
6. AWS IoT 收到该消息，它更新设备影子中的 desired state，同时发送包含期望状态的 message 到某些topic。此时，reported 和 desired 状态是 『Out of Sync』的
7. led 收到 delta 消息，开始根据其中的 desired status 来设置其实际状态
8. led 将其状态设置为 on，向 MQTT topic 发送新的 reported 状态
9. AWS IoT 更新设备影子，现在该设备的 reported 和 desired 状态一致了</p> <h2 id="格式"><a href="#格式" aria-hidden="true" class="header-anchor">#</a> 格式</h2> <p><img src="/uploads/ba398a3c48b6b7d77d8a2f048735550a/image.png" alt="image"></p> <h2 id="关键属性"><a href="#关键属性" aria-hidden="true" class="header-anchor">#</a> 关键属性</h2> <p><img src="/uploads/e2b49474ae7db2783464ea52d205acfd/image.png" alt="image"></p> <h3 id="影子文档属性"><a href="#影子文档属性" aria-hidden="true" class="header-anchor">#</a> 影子文档属性</h3> <p>设备的影子文档具有以下属性：</p> <ul><li>state</li></ul> <ul><li><p>desired 事物的预期状态。应用程序可以向本文档部分写入数据来更新事物的状态，且无需直接连接到该事物。</p></li> <li><p>reported 事物的报告状态。事物可以向本文档部分写入数据，以报告其新状态。应用程序可以读取本文档部分，以确定事物的状态。</p></li> <li><p>metadata 有关存储在文档 state 部分的数据的信息，其中包括 state 部分中每个属性的时间戳（以 Epoch 时间表示），让您能够确定它们的更新时间。</p></li> <li><p>timestamp 指明 AWS IoT 传输消息的时间。通过在消息中使用时间戳并对 desired 或 reported 部分中的不同属性使用时间戳，事物可以确定已更新项目的存在时间，即使它不具有内部时钟特性。</p></li> <li><p>clientToken 特定于设备的字符串，让您能在 MQTT 环境中将响应与请求关联起来。</p></li> <li><p>version 文档版本。文档每次更新时，此版本号都会递增。用于确保正在更新的文档为最新版本。</p></li></ul> <h3 id="影子文档语法"><a href="#影子文档语法" aria-hidden="true" class="header-anchor">#</a> 影子文档语法</h3> <h4 id="请求结构"><a href="#请求结构" aria-hidden="true" class="header-anchor">#</a> 请求结构</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;desired&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer2<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string2&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean2
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reported&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer1<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string1&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean1
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token property">&quot;clientToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> version
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="响应状态"><a href="#响应状态" aria-hidden="true" class="header-anchor">#</a> 响应状态</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;desired&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer2<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string2&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean2
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reported&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> integer1<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string1&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> boolean1
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;delta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute3&quot;</span><span class="token operator">:</span> integerX<span class="token punctuation">,</span>
            <span class="token property">&quot;attribute5&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stringY&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;desired&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reported&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attribute1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;attribute2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;attributeN&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp<span class="token punctuation">,</span>
    <span class="token property">&quot;clientToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> version
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h4 id="错误响应"><a href="#错误响应" aria-hidden="true" class="header-anchor">#</a> 错误响应</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> error-code<span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error-message&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> timestamp<span class="token punctuation">,</span>
    <span class="token property">&quot;clientToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;token&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="预留主题"><a href="#预留主题" aria-hidden="true" class="header-anchor">#</a> 预留主题</h2> <p>aws Iot预留了一些主题，预留的主题以$开头。除非下面列出的主题之外，不支持用于进行发布和订阅。在任何其他以 $ 开头的主题中尝试发布或订阅将导致连接被终止。</p> <table><thead><tr><th>主题</th> <th>允许的操作</th> <th>描述</th></tr></thead> <tbody><tr><td>$aws/events/presence/connected/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端连接至 AWS IoT 时，AWS IoT 将向此主题发布。有关更多信息，请参阅 连接/断开连接事件。</td></tr> <tr><td>$aws/events/presence/disconnected/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端与 AWS IoT 断开连接时，AWS IoT 将向此主题发布。有关更多信息，请参阅 连接/断开连接事件。</td></tr> <tr><td>$aws/events/subscriptions/subscribed/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端订阅 MQTT 主题时，AWS IoT 将向此主题发布。有关更多信息，请参阅 订阅/取消订阅事件。</td></tr> <tr><td>$aws/events/subscriptions/unsubscribed/clientId</td> <td>Subscribe</td> <td>当使用特定客户端 ID 的 MQTT 客户端取消订阅 MQTT 主题时，AWS IoT 将向此主题发布。有关更多信息，请参阅 订阅/取消订阅事件。</td></tr> <tr><td>$aws/things/thingName/shadow/delete</td> <td>发布/订阅</td> <td>设备或应用程序向此主题发布消息以删除影子。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#delete-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/delete/accepted</td> <td>Subscribe</td> <td>当一个影子被删除时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#delete-accepted-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/delete/rejected</td> <td>Subscribe</td> <td>当删除影子的请求遭拒时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#delete-rejected-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/get</td> <td>发布/订阅</td> <td>应用程序或事物向此主题发布空消息来获取影子。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html。</td></tr> <tr><td>$aws/things/thingName/shadow/get/accepted</td> <td>Subscribe</td> <td>当获取影子的请求获批时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#get-accepted-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/get/rejected</td> <td>Subscribe</td> <td>当获取影子的请求遭拒时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#get-rejected-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update</td> <td>发布/订阅</td> <td>事物或应用程序向此主题发布消息以更新影子。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/accepted</td> <td>Subscribe</td> <td>当影子更新成功时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-accepted-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/rejected</td> <td>Subscribe</td> <td>当影子更新遭拒时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-rejected-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/delta</td> <td>Subscribe</td> <td>当检测到影子的“reported”部分与“desired”部分之间存在差异时，Device Shadow 服务将向此主题发送消息。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-delta-pub-sub-topic。</td></tr> <tr><td>$aws/things/thingName/shadow/update/documents</td> <td>Subscribe</td> <td>每次影子更新成功执行时，AWS IoT 都会向该主题发布状态文档。有关更多信息，请参阅 http://docs.aws.amazon.com/iot/latest/developerguide//device-shadow-mqtt.html#update-documents-pub-sub-topic。</td></tr></tbody></table></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/35.6a4f99be.js" defer></script><script src="/assets/js/app.7863e8ac.js" defer></script>
  </body>
</html>
